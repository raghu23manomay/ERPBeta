@model XRP.Models.Paged_ssmtbl_WorkorderDetailsModel
@{
    ViewBag.Title = "AllWorkOrderDetails";
    ViewBag.Active = "Marketing";
    Layout = "~/Views/Shared/_DesignLayout.cshtml";
}
@using (Html.BeginForm("AllWorkOrderDetails", "WorkOrderDetails", FormMethod.Get, new { @class = "form-horizontal", role = "form", enctype = "multipart/form-data" }))
{
    @Html.ValidationSummary(true)
    <fieldset>

        <!-- PAGE TITLE -->
        <header class="blue accent-3 relative">
            <div class="container-fluid text-white">
                <div class="row p-t-b-10 ">
                    <div class="col">
                        <h4>
                            <i class="icon-database"></i>
                            WorkOrderDetails
                        </h4>
                    </div>
                </div>
                <div class="row justify-content-between">
                    <ul class="nav nav-material nav-material-white responsive-tab" id="v-pills-tab" role="tablist">
                        <li>
                            <a class="nav-link active" id="v-pills-all-tab" data-toggle="pill" href="#v-pills-all" role="tab" aria-controls="v-pills-all"><i class="icon icon-home2"></i>ALL WorkOrderDetails</a>
                        </li>


                    </ul>
                </div>
            </div>

        </header>
        <form class="form-horizontal">
            <div class="panel panel-default tabs">

                <!-- Nav tabs -->
                <ul class="nav nav-material nav-material-white responsive-tab" role="tablist">
                    <li><a href="#first" aria-controls="first" role="tab" data-toggle="tab" class="nav-link">Unit 1</a></li>
                    <li><a href="#second" aria-controls="second" role="tab" data-toggle="tab" class="nav-link">Unit 2</a></li>
                    <li><a href="#third" aria-controls="third" role="tab" data-toggle="tab" class="nav-link">Unit 3</a></li>
                    <li><a href="#fourth" aria-controls="fourth" role="tab" data-toggle="tab" class="nav-link">Unit 4</a></li>
                </ul>
                <div class="container-fluid animatedParent animateOnce">
                    <div class="tab-content my-3" id="v-pills-tabContent">
                        <div class="tab-pane animated fadeInUpShort show active" id="v-pills-all" role="tabpanel" aria-labelledby="v-pills-all-tab">
                            <div class="row my-3">
                                <div class="col-md-12">
                                    <div class="card r-0 shadow">
                                        <div class="table-responsive">
                                            <form action="">
                                                <div class="panel-body tab-content">
                                                    <div role="tabpanel" class="tab-pane active" id="first">
                                                        <div class="panel-body panel-body-table">
                                                            <div style="width:auto;height:auto;overflow-x:auto;overflow-y:auto;">
                                                                <table class="table table-striped table-hover r-0" id="wodtbl">
                                                                    <thead>
                                                                        <tr>
                                                                            <th> WO No</th>
                                                                            <th> TargetDate</th>
                                                                            <th>Balance Qnty</th>
                                                                            <th>
                                                                                Cutting
                                                                            </th>
                                                                            <th>
                                                                                Forging
                                                                            </th>
                                                                            <th>
                                                                                Balance<br /> Trimming
                                                                            </th>
                                                                            <th>
                                                                                Heat <br />Treatment
                                                                            </th>
                                                                            <th>
                                                                                Welding
                                                                            </th>
                                                                            <th>
                                                                                Shot<br />Blasting

                                                                            </th>
                                                                            <th>
                                                                                Fettling
                                                                            </th>
                                                                            <th>
                                                                                Machinging
                                                                            </th>
                                                                            <th colspan="2">
                                                                                <table width="100%">
                                                                                    <tr>
                                                                                        <th colspan="2"><center>Rejected QC</center></th>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <th>
                                                                                            <center>Inprocess</center>
                                                                                        </th>
                                                                                        <th>
                                                                                            <center>Final</center>
                                                                                        </th>
                                                                                    </tr>
                                                                                </table>
                                                                            </th>


                                                                            <th style="display:none">
                                                                                Dispatch
                                                                            </th>
                                                                            <th></th>
                                                                            <th></th>
                                                                        </tr>

                                                                    </thead>
                                                                    <tbody></tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div role="tabpanel" class="tab-pane" id="second">
                                                        <div class="panel-body panel-body-table">
                                                            <div style="width: auto; height: auto; overflow-x: auto; overflow-y: auto;">
                                                                <table class="table table-striped table-hover r-0" id="wodtbl1">
                                                                    <thead>
                                                                        <tr>
                                                                            <th> WO No</th>
                                                                            <th> TargetDate</th>
                                                                            <th>Balance Qnty</th>
                                                                            <th>
                                                                                Cutting
                                                                            </th>
                                                                            <th>
                                                                                Forging
                                                                            </th>
                                                                            <th>
                                                                                Balance<br /> Trimming
                                                                            </th>
                                                                            <th>
                                                                                Heat <br />Treatment
                                                                            </th>
                                                                            <th>
                                                                                Welding
                                                                            </th>
                                                                            <th>
                                                                                Shot<br />Blasting

                                                                            </th>
                                                                            <th>
                                                                                Fettling
                                                                            </th>
                                                                            <th>
                                                                                Machinging
                                                                            </th>
                                                                            <th colspan="2">
                                                                                <table width="100%">
                                                                                    <tr>
                                                                                        <th colspan="2"><center>Rejected QC</center></th>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <th>
                                                                                            <center>Inprocess</center>
                                                                                        </th>
                                                                                        <th>
                                                                                            <center>Final</center>
                                                                                        </th>
                                                                                    </tr>
                                                                                </table>
                                                                            </th>


                                                                            <th style="display:none">
                                                                                Dispatch
                                                                            </th>
                                                                            <th></th>
                                                                            <th></th>
                                                                        </tr>

                                                                    </thead>
                                                                    <tbody></tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div role="tabpanel" class="tab-pane" id="third">
                                                        <div class="panel-body panel-body-table">
                                                            <div style="width: auto; height: auto; overflow-x: auto; overflow-y: auto;">
                                                                <table class="table table-striped table-hover r-0" id="wodtbl2">
                                                                    <thead>
                                                                        <tr>
                                                                            <th> WO No</th>
                                                                            <th> TargetDate</th>
                                                                            <th>Balance Qnty</th>
                                                                            <th>
                                                                                Cutting
                                                                            </th>
                                                                            <th>
                                                                                Forging
                                                                            </th>
                                                                            <th>
                                                                                Balance<br /> Trimming
                                                                            </th>
                                                                            <th>
                                                                                Heat <br />Treatment
                                                                            </th>
                                                                            <th>
                                                                                Welding
                                                                            </th>
                                                                            <th>
                                                                                Shot<br />Blasting

                                                                            </th>
                                                                            <th>
                                                                                Fettling
                                                                            </th>
                                                                            <th>
                                                                                Machinging
                                                                            </th>
                                                                            <th colspan="2">
                                                                                <table width="100%">
                                                                                    <tr>
                                                                                        <th colspan="2"><center>Rejected QC</center></th>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <th>
                                                                                            <center>Inprocess</center>
                                                                                        </th>
                                                                                        <th>
                                                                                            <center>Final</center>
                                                                                        </th>
                                                                                    </tr>
                                                                                </table>
                                                                            </th>


                                                                            <th style="display:none">
                                                                                Dispatch
                                                                            </th>
                                                                            <th></th>
                                                                            <th></th>
                                                                        </tr>

                                                                    </thead>
                                                                    <tbody></tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div role="tabpanel" class="tab-pane" id="fourth">
                                                        <div class="panel-body panel-body-table">
                                                            <div style="width: auto; height: auto; overflow-x: auto; overflow-y: auto;">
                                                                <table class="table table-striped table-hover r-0" id="wodtbl3">
                                                                    <thead>
                                                                        <tr>
                                                                            <th> WO No</th>
                                                                            <th> TargetDate</th>
                                                                            <th>Balance Qnty</th>
                                                                            <th>
                                                                                Cutting
                                                                            </th>
                                                                            <th>
                                                                                Forging
                                                                            </th>
                                                                            <th>
                                                                                Balance<br /> Trimming
                                                                            </th>
                                                                            <th>
                                                                                Heat <br />Treatment
                                                                            </th>
                                                                            <th>
                                                                                Welding
                                                                            </th>
                                                                            <th>
                                                                                Shot<br />Blasting

                                                                            </th>
                                                                            <th>
                                                                                Fettling
                                                                            </th>
                                                                            <th>
                                                                                Machinging
                                                                            </th>
                                                                            <th colspan="2">
                                                                                <table width="100%">
                                                                                    <tr>
                                                                                        <th colspan="2"><center>Rejected QC</center></th>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <th>
                                                                                            <center>Inprocess</center>
                                                                                        </th>
                                                                                        <th>
                                                                                            <center>Final</center>
                                                                                        </th>
                                                                                    </tr>
                                                                                </table>
                                                                            </th>


                                                                            <th style="display:none">
                                                                                Dispatch
                                                                            </th>
                                                                            <th></th>
                                                                            <th></th>
                                                                        </tr>

                                                                    </thead>
                                                                    <tbody></tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </form>


    </fieldset>



    <script src="~/Scripts/jquery-2.1.4.min.js"></script>
    <link href="~/Content/themes/base/all.css" rel="stylesheet" />
    <script type="text/javascript" src="~/Scripts/jquery-1.10.2.js"></script>
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Scripts/date.format.js" type="text/javascript"></script>
    <script src="~/Content/Validations/JqueryUi.js"></script>
    <link href="~/NewCssAndTheme/FancyBox/jquery.fancybox.css" rel="stylesheet" />
    <script src="~/NewCssAndTheme/FancyBox/jquery.fancybox.pack.js"></script>
    <script type="text/javascript">
        var $j = jQuery.noConflict(true);
    </script>


    <script type="text/javascript">
        $(document).ready(function () {
            loaddefault();

        });
        function loaddefault() {

            $("#wodtbl").empty();
            $("#wodtbl1").empty();
            $("#wodtbl2").empty();
            $("#wodtbl3").empty();
            var tra1 = '<tr class="tblheadtr"> <td>WorkOrder No</td> <td style="display:none">Hc</td><td>RM</td><td> Die No</td> <td> TargetDate</td><td>Balance Qnty</td>'
            var tra2 = '';
            $.getJSON("../WorkOrderDetails/GetAllOprations", function (data) {

                $.each(data, function (i, data) {
                    tra2 = tra2 + '<td id=head_"' + data.id + '">' + data.operationinvolvedname + '</td>';
                });
                var tra3 = ' <td colspan="2">  <table width="100%"><tr> <td colspan="2"><center>Rejected QC</center></td> </tr>' +
                                             '<tr> <td>  <center>Inprocess</center>        </td>  <td><center>Final</center></td> </tr>   </table> </td>' +
                                    ' <td  >  Dispatch  </td> <td></td>  <td></td></tr>';
                $("#wodtbl").append(tra1 + tra2 + tra3);
                $("#wodtbl1").append(tra1 + tra2 + tra3);
                $("#wodtbl2").append(tra1 + tra2 + tra3);
                $("#wodtbl3").append(tra1 + tra2 + tra3);
                //table head part  append complete
                //table body part work order details part start
                var trB1 = '';
                var trb2 = '';
                $.getJSON("../WorkOrderDetails/GetAllTotalAndUpdatetime", function (datatotandupdate) {
                    $.getJSON("../WorkOrderDetails/GetAllWorkOrders", function (datawo) {
                        $.each(datawo, function (i, datawo) {
                            if (datawo.ProductionUnit == 1) {
                                if (datawo.status == 602) {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                  ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +

                                          //var date = new Date(parseInt((datawo.Targetdate).substr(6)));
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) + '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.Wono + '"/>' +
                                           '<td class="tblbodylbl">' + // convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl").append(trB1);
                                    }
                                }
                                else {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);
                                        var trgetDt =
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                           //'<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary"  id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                         //  '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl").append(trB1);
                                    }
                                }
                            }
                            else if (datawo.ProductionUnit == 2) {
                                if (datawo.status == 602) {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +

                                          //var date = new Date(parseInt((datawo.Targetdate).substr(6)));
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl1").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) + '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.Wono + '"/>' +
                                           '<td class="tblbodylbl">' + // convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl1").append(trB1);
                                    }
                                }
                                else {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);
                                        var trgetDt =
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                           //'<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary"  id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl1").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                         //  '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl1").append(trB1);
                                    }
                                }
                            }
                            else if (datawo.ProductionUnit == 3) {
                                if (datawo.status == 602) {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +

                                          //var date = new Date(parseInt((datawo.Targetdate).substr(6)));
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl2").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) + '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.Wono + '"/>' +
                                           '<td class="tblbodylbl">' + // convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl2").append(trB1);
                                    }
                                }
                                else {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);
                                        var trgetDt =
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                           //'<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary"  id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl2").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                         //  '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl2").append(trB1);
                                    }
                                }
                            } else {
                                if (datawo.status == 602) {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +

                                          //var date = new Date(parseInt((datawo.Targetdate).substr(6)));
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl3").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                          // '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) + '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.Wono + '"/>' +
                                           '<td class="tblbodylbl">' + // convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl3").append(trB1);
                                    }
                                }
                                else {
                                    if (datawo.Hc == "" || datawo.Hc == null) {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);
                                        var trgetDt =
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';
                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                   ' <td class="tblbodytxt"><a href="#" class="btn_rmhideshow">Click to Set</a><input class="txtwidths" type="text" style="display:none;">&nbsp;&nbsp;<button class="btn_rmfind"  style="display:none;">Update</button></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                           //'<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                            '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/></td>' +
                                          ' <td class="tblbodylbl" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {
                                                //  (p.length-1)==indextofcurrop

                                                //     next1 = p[indextofcurrop + 1];
                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101" value="0" name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                      '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary"  id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;
                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl3").append(trB1);


                                    }
                                    else {

                                        trB1 = '';
                                        trb2 = '';
                                        var balancesd = ((datawo.calbalance == 'null' || datawo.calbalance == null || datawo.calbalance == '') ? 0 : datawo.calbalance);

                                        var pendingbal = (datawo.pendingbal);
                                        var tallybal = parseFloat(balancesd - pendingbal);
                                        if (tallybal == 0) {

                                        }
                                        //  var balancesd = ((datawo.Balanceqty == 'null' || datawo.Balanceqty == null || datawo.Balanceqty == '') ? 0 : datawo.Balanceqty)
                                        trB1 = trB1 + '<tr id="tbody_' + datawo.ID + '">' +// </tr>';

                                             ' <td class="tblbodytxt"><a href="#" class="btn_woforview">' + datawo.WorkorderNo + '</a></td>' +
                                        ' <td style="display:none"><a href="#" >' + datawo.Rawmaterial + '</a></td>' +
                                        ' <td><a href="#" class="btn_RMInvent">' + (datawo.RMQty == null ? '0' : datawo.RMQty) + '</a></td>' +
                                   ' <td class="tblbodylbl">' + datawo.Dieno + '</td>' +
                                         //  '<td class="tblbodylbl">' + convertjsontodatedmy(datawo.Targetdate) +
                                          '<td class="tblbodylbl">' + (new Date(parseInt((datawo.Targetdate).substr(6)))).format("dd/mm/yyyy") +
                                           '<input type="hidden" id="hdd_pono_' + datawo.ID + '" value="' + datawo.Pono + '"/><input type="hidden" id="hdd_wono_' + datawo.ID + '" value="' + datawo.WorkorderNo + '"/>' +
                                            '</td>' +
                                          ' <td class="tblbodylbl" id="balancetd_' + datawo.ID + '" align="right">' + balancesd + ' </td>';
                                        trb2 = '';
                                        var lstopis = 0;
                                        //   var ops = datawo.opearationinvolved1
                                        var ops = (datawo.opearationinvolved1 == null ? '' : datawo.opearationinvolved1)
                                        //  alert(datawo.Wono + " " + ops);
                                        var projectsstr = (ops.split(','));
                                        var p = [];//[645, 629, 648];
                                        for (var ii = 0; ii < projectsstr.length; ii++)
                                            p.push(parseInt(projectsstr[ii])
                                                );
                                        //    alert(p + " p[0] =" + p[0] + " p[1] =" + p[1] + " p[2] =" + p[2]);
                                        //    alert(p + " projects.indexOf(1) =" + p.indexOf(1) + " projects.indexOf(2) =" + p.indexOf(2) + " projects.indexOf(4) =" + p.indexOf(4) + " projects.indexOf(3) =" + p.indexOf(3) + " projects.indexOf(6) =" + p.indexOf(6));
                                        $.each(data, function (i, data) {
                                            var start = data.id;

                                            var next1 = 0;// p[($.inArray(start, p) + 1) % p.length];
                                            var prev = 0;// p[($.inArray(start, p) - 1 + p.length) % p.length];
                                            var indextofcurrop = p.indexOf(start);
                                            if (indextofcurrop != -1) {

                                                if (indextofcurrop == 0)
                                                    prev = 0;// p[indextofcurrop - 1];
                                                else
                                                    prev = p[indextofcurrop - 1];

                                            }
                                            if (p.indexOf(start) == -1) {
                                                //   next1 =0;
                                                prev = 0;
                                            }
                                            //   alert("prev " + prev + " selected " + data.id + " next1 " + next1 + "  next(p, start)" + next(p, start) + "   previous(p, start) " + previous(p, start));

                                            //  trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + data.previousopid + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            //   lstopis = data.id;
                                            if (prev == 0 && start != 1)
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';
                                            else
                                                trb2 = trb2 + '  <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '"  name="txt_woid_' + datawo.ID + '_opid_' + data.id + '_' + prev + '" /><br /> <span id="spntot_' + datawo.ID + '_opid_' + data.id + '"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_' + data.id + '">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_' + data.id + '"  /></td>';

                                            lstopis = indextofcurrop != -1 ? start : lstopis;// data.id;

                                        });

                                        trB1 = trB1 + trb2 +
                                                                     ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"  name="txt_woid_' + datawo.ID + '_opid_100_' + lstopis + '"/><br /> <span id="spntot_' + datawo.ID + '_opid_100"></span> <br /><span class="dtsize"  id="spnudwod_' + datawo.ID + '_opid_100"></span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_100" value="' + lstopis + '" /></td>' +
                                                                        ' <td class="tblbodytxt"><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_101_100"  name="txt_woid_' + datawo.ID + '_opid_101_100"/><br /><span id="spntot_' + datawo.ID + '_opid_101"></span> <br /><span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_101">  </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_101" value="100" /></td>' +
                                                                       '  <td class="tblbodytxt"  ><input class="txtwidths Float-Number" readonly="readonly" type="text" id="txt_woid_' + datawo.ID + '_opid_102_101"  name="txt_woid_' + datawo.ID + '_opid_102_101"/><br /> <span id="spntot_' + datawo.ID + '_opid_102"></span> <br /> <span class="dtsize" id="spnudwod_' + datawo.ID + '_opid_102"> </span><input type="hidden" id="preopidwod_' + datawo.ID + '_opid_102" value="101" /></td>' +
                                                                       '  <td>  <button class="savewod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="Save_' + datawo.ID + '" value="Save" disabled="disabled"><span class="ui-button-icon-primary ui-icon ui-icon-disk btn-size"></span><span class="ui-button-text btn-size">Save</span></button></td><td><button class="emailwod ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" id="email_' + datawo.ID + '" value="email" disabled="disabled"><span class="ui-button-icon-primary ui-icon  ui-icon-mail-closed btn-size"></span><span class="ui-button-text btn-size">Email</span></button></button> </td>'
                                        ;

                                        trB1 = trB1 + '</tr>';
                                        $("#wodtbl3").append(trB1);
                                    }
                                }
                            }
                        });

                        $.each(datatotandupdate, function (i, datatotandupdate) {
                            var txtid = '';
                            var spntotid = 'spntot_' + datatotandupdate.ID + '_opid_' + datatotandupdate.Operationid;
                            var spnupwod = 'spnudwod_' + datatotandupdate.ID + '_opid_' + datatotandupdate.Operationid;
                            var spntotdispach = 'spntot_' + datatotandupdate.ID + '_opid_102';
                            if (datatotandupdate.Operationid != 0) {
                                $("#" + spntotid).text(datatotandupdate.total);
                                $("#" + spnupwod).text(datatotandupdate.updatedate);
                                $("#" + spntotdispach).text(datatotandupdate.Dispatchqtyfromdc);
                                // datatotandupdate.Dispatchqtyfromdc
                            }

                            var preoid = 'preopidwod_' + datatotandupdate.ID + '_opid_' + datatotandupdate.Operationid;
                            if (preoid != 'preopidwod_1_opid_100')
                                $("#" + preoid).val(datatotandupdate.preopids);

                            if (datatotandupdate.Operationid == 101)
                                $("#" + preoid).val(100);
                            if (datatotandupdate.Operationid == 102)
                                $("#" + preoid).val(101);

                        });
                    });
                });
            });
        }

        $(document).on("click", ".savewod", function () {

            var sp = (this.id).split('_');
            //alert(sp);
            var woID = sp[1];
            //alert(woID);
            var wono = $("#hdd_wono_" + woID).val();
            // var CrDate = getcurrendate();
            var CrBy = $("#crbytxt").val();
            var $trval = $(this).closest('tr');
            // var Allopsinworow = $('#tbody_' + woID).find("td");
            var Allopsinworow = $trval.find("td");
            //  alert(Allopsinworow.length);
            var txtx = 'txt_woid_' + woID + '_opid_';
            //alert(txtx);

            var masterRootconcate = '';
            var cnt = 0;
            $("[name^='" + txtx + "']").each(function () {
                // if (this.id == txtx)
                var $root = $('<XMLDocument />');
                var $Rowdata = $('<routecarddatas />');
                var opids = this.id.split('_');
                var Actqnty = parseFloat(($(this).val() == '' || $(this).val() == null || $(this).val() == 'null') ? 0 : $(this).val());//
                var OPId = opids[4];
                var OPIDpre = opids[5];
                var prsoid = parseInt(OPId);
                var balid = 'balancetd_' + woID;
                var bal = parseFloat($("#" + balid).html());
                // alert(bal + ' value=' + parseFloat(bal));

                if (OPIDpre != 0 && (OPId != 100 && OPId != 101)) //  if (OPIDpre != 0)
                {
                    var Actqntypre = 'txt_woid_' + woID + '_opid_' + OPIDpre + '_';
                    //  alert(Actqntypre);
                    var Actqntypreid = $("[name^='" + Actqntypre + "']").first().val();
                    var ActAmtpre = parseFloat(Actqntypreid);//$("#" + Actqntypreid.id).val());
                    var spntotid = 'spntot_' + woID + '_opid_' + OPIDpre;
                    var ActTotAmtpre = parseFloat($("#" + spntotid).text());
                    if (isNaN(ActTotAmtpre)) {
                        ActTotAmtpre = 0;
                    }
                    if (isNaN(ActAmtpre)) {
                        ActAmtpre = 0;
                    }
                    var spntotidcurr = 'spntot_' + woID + '_opid_' + OPId;
                    var ActTotAmtcurr = parseFloat($("#" + spntotidcurr).text());
                    if (isNaN(ActTotAmtcurr)) {
                        ActTotAmtcurr = 0;
                    }
                    var preTotalQty = ActTotAmtpre + ActAmtpre;
                    var currTatalQty = ActTotAmtcurr + Actqnty;
                    //   alert(preTotalQty + ' ' + currTatalQty);

                    if (prsoid == 102) {
                        preTotalQty = bal;
                    }
                    if (preTotalQty < currTatalQty) {
                        // alert(" preTotalQty < currTatalQty " + preTotalQty + " " + currTatalQty);

                        alert("This Is Wrong ");
                        cnt++;
                        return false;
                    }
                }
                // alert(this.id);

                $Rowdata.append($('<routecarddata />').append
            (
              $('<wono />').text('' + wono + ''),
              $('<pono />').text('' + $('#hdd_pono_' + woID).val() + ''),
              $('<operationid />').text('' + OPId + ''),
             // $('<shift />').text('' + shid + ''),
            //  $('<opdate />').text('' + converttodate(sdate) + ''),
              $('<actualQnty />').text('' + Actqnty + ''),
             // $('<comment />').text('' + $('#txt_comment').val() + ''),
              $('<createdby />').text('' + CrBy + '')//,
            //  $('<createddate />').text('' + CrDate + '')
            ));

                $root.append($Rowdata);
                var xml = $root.html();
                masterRootconcate = masterRootconcate + xml + '^';
            });

            var masterRootconcate1 = masterRootconcate.trim('^');
            //  alert(masterRootconcate1);

            //   urls = "/WorkOrder/Save_WorkOrder";
            var dm = JSON.stringify({ xml: ' ' + masterRootconcate1 + '' });
            if (cnt == 0) {
                $.ajax
                 ({
                     type: "POST",
                     url: "../WorkOrderDetails/Save_WorkOrderDetailNew",
                     data: dm,// JSON.stringify({ xml: ' ' + xml + '' }),
                     contentType: "application/json;charset=utf-8",
                     dataType: "json",
                     success: function (status) {
                         loaddefault();
                     },
                     error: function (err) {
                         //  alert('Error occured');
                         errormsg("divwarn", 'Error occured');
                         stoploading();
                     }
                 });
                var dispatchtxt = 'txt_woid_' + woID + '_opid_' + '102_101';
                var txtdisv = ($("#" + dispatchtxt).val());
                var inputdispatchq = "";
                if (txtdisv == "") {
                    inputdispatchq = "0";
                }
                else {
                    inputdispatchq = txtdisv;
                }


                var balsid = 'balancetd_' + woID;

                var dispachsid = 'spntot_' + woID + '_opid_102';
                var balval = $('#' + balsid).html();
                var dispachval = $('#' + dispachsid).text(); var datadispachval = dispachval == '' ? 0 : dispachval;
                //    alert(balval); alert(datadispachval); alert(wono);
                var totaldispatch = parseFloat(inputdispatchq) + parseFloat(datadispachval);
                //updateWorkOrdersbalanddispach(string wono,Double bal,double dispach)

                var datain = JSON.stringify({ wono: wono, bal: balval, totaldispatch: totaldispatch });
                $.ajax({
                    type: "POST",
                    url: "../WorkOrderDetails/updateWorkOrdersbalanddispach",
                    // data: params,
                    data: datain,// JSON.stringify({ xml: ' ' + xml + '' }),
                    contentType: "application/json;charset=utf-8",
                    dataType: "json",
                    success: function (status) { loaddefault(); }
                });
            }
            else {
                alert("Please fill all proper data");
            }


        });
        $(document).on("focusout", ".txtwidths", function () {

            var opids = this.id.split('_');
            //alert(opids);
            var Actqnty = parseFloat(($(this).val() == '' || $(this).val() == null || $(this).val() == 'null') ? 0 : $(this).val());//

            var OPId = opids[4];
            var OPIDpre = opids[5];
            var woID = opids[2];
            var preoid = 'preopidwod_' + woID + '_opid_' + OPId;
            var preid = $("#" + preoid).val();
            //     OPIDpre = preid;
            // alert(preid);
            var prsoid = parseInt(OPId);
            //  alert(OPId + '' + (prsoid != 100 && prsoid != 101));
            var balid = 'balancetd_' + woID;
            var bal = parseFloat($("#" + balid).html());
            // alert(bal + ' value=' + parseFloat(bal));

            if (OPIDpre != 0 && (OPId != 100 && OPId != 101)) {
                var Actqntypre = 'txt_woid_' + woID + '_opid_' + OPIDpre + '_';
                // alert("Actqntypre" + Actqntypre);
                var $Actqntypreid = $("[name^='" + Actqntypre + "']").first().val();
                // alert("$Actqntypreid" + $Actqntypreid );
                var ActAmtpre = parseFloat($Actqntypreid);

                var spntotid = 'spntot_' + woID + '_opid_' + OPIDpre;
                var ActTotAmtpre = parseFloat($("#" + spntotid).text());

                if (isNaN(ActTotAmtpre)) {
                    ActTotAmtpre = 0;
                }
                if (isNaN(ActAmtpre)) {
                    ActAmtpre = 0;
                }
                //  alert("ActTotAmtpre" + ActTotAmtpre + "ActAmtpre" + ActAmtpre);

                var spntotidcurr = 'spntot_' + woID + '_opid_' + OPId;



                var ActTotAmtcurr = parseFloat($("#" + spntotidcurr).text());
                if (isNaN(ActTotAmtcurr)) {
                    ActTotAmtcurr = 0;
                }
                //  alert("ActTotAmtcurr" + ActTotAmtcurr + "Actqnty" + Actqnty);
                var preTotalQty = ActTotAmtpre + ActAmtpre;
                var currTatalQty = ActTotAmtcurr + Actqnty;
                //if (this.id == 'txt_woid_1_opid_101_100')
                //{
                //    alert(Actqntypre + ' '+ preTotalQty + ' ' + currTatalQty);
                //}
                if (prsoid == 102) {
                    preTotalQty = bal;
                }
                if (preTotalQty < currTatalQty) {
                    $("#" + this.id).focus();
                    $("#" + this.id).addClass('tdborder');
                }
                else {
                    $("#" + this.id).removeClass('tdborder');
                }
            }
        });
        $("#wodtbl").on('click', '.btn_woforview', function () {
            var currentRow = $(this).closest("tr");
            var wono = currentRow.find("td:eq(0)").text();
            $.ajax({
                type: "GET",
                url: "../WorkOrderDetails/WorkorderDetails",
                contentType: "application/json;charset=utf-8",
                data: { wono: wono },
                success: function () {
                    window.open("../WorkOrderDetails/WorkorderDetails/?wono=" + wono, "WindowPopup", "width=850,height=450,autoOpen=false,position=center,toolbar=no,menubar=no,scrollbars=no");
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Status: " + textStatus); alert("Error: " + errorThrown);
                }
            });
        });
        $("#wodtbl1").on('click', '.btn_woforview', function () {
            var currentRow = $(this).closest("tr");
            var wono = currentRow.find("td:eq(0)").text();
            $.ajax({
                type: "GET",
                url: "../WorkOrderDetails/WorkorderDetails",
                contentType: "application/json;charset=utf-8",
                data: { wono: wono },
                success: function () {
                    window.open("../WorkOrderDetails/WorkorderDetails/?wono=" + wono, "WindowPopup", "width=850,height=450,autoOpen=false,position=center,toolbar=no,menubar=no,scrollbars=no");
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Status: " + textStatus); alert("Error: " + errorThrown);
                }
            });
        });
        $("#wodtbl2").on('click', '.btn_woforview', function () {
            var currentRow = $(this).closest("tr");
            var wono = currentRow.find("td:eq(0)").text();
            $.ajax({
                type: "GET",
                url: "../WorkOrderDetails/WorkorderDetails",
                contentType: "application/json;charset=utf-8",
                data: { wono: wono },
                success: function () {
                    window.open("../WorkOrderDetails/WorkorderDetails/?wono=" + wono, "WindowPopup", "width=850,height=450,autoOpen=false,position=center,toolbar=no,menubar=no,scrollbars=no");
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Status: " + textStatus); alert("Error: " + errorThrown);
                }
            });
        });
        $("#wodtbl3").on('click', '.btn_woforview', function () {
            var currentRow = $(this).closest("tr");
            var wono = currentRow.find("td:eq(0)").text();
            $.ajax({
                type: "GET",
                url: "../WorkOrderDetails/WorkorderDetails",
                contentType: "application/json;charset=utf-8",
                data: { wono: wono },
                success: function () {
                    window.open("../WorkOrderDetails/WorkorderDetails/?wono=" + wono, "WindowPopup", "width=850,height=450,autoOpen=false,position=center,toolbar=no,menubar=no,scrollbars=no");
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Status: " + textStatus); alert("Error: " + errorThrown);
                }
            });
        });
        $(document).on("click", ".emailwod", function () {
            var sp = (this.id).split('_');
            var woID = sp[1];
            var pono = $("#hdd_pono_" + woID).val();

            var wono = $("#hdd_wono_" + woID).val();
            var CrBy = $("#crbytxt").val();
            var $trval = $(this).closest('tr');
            // var Allopsinworow = $('#tbody_' + woID).find("td");
            var Allopsinworow = $trval.find("td");
            var toatlforgingid = "spntot_" + woID + "_opid_1";
            var toatlmpiid = "spntot_" + woID + "_opid_2";
            var toatlsbid = "spntot_" + woID + "_opid_3";
            var toatlhtid = "spntot_" + woID + "_opid_4";

            var toatlforging = $("#" + toatlforgingid).text();
            var toatlmpi = $("#" + toatlmpiid).text();
            var toatlsb = $("#" + toatlsbid).text();
            var toatlht = $("#" + toatlhtid).text();

            //alert("toatlforging " + toatlforging + " toatlmpi " + toatlmpi + " toatlsb " + toatlsb + " toatlht " + toatlht + "");
            //alert(woID);
            TriggerOutlook(toatlforging, toatlmpi, toatlsb, toatlht, pono);
        });
    </script>
    <style>
        .table1 > tbody > tr > td, .table > tbody > tr > th, .table > tfoot > tr > td, .table > tfoot > tr > th, .table > thead > tr > td, .table > thead > tr > th {
            padding: 2px;
            line-height: 1.2;
            vertical-align: top;
        }

        .dataTables_wrapper {
            font-family: tahoma;
            font-size: 12px;
            direction: ltr;
            position: relative;
            clear: both;
            *zoom: 1;
            zoom: 1;
        }
    </style>
    <style>
                .nav nav-tabs {
                    background-color: black;
                }

                    .nav nav-tabs active {
                        background-color: whitesmoke;
                    }

                .btn-size {
                    font-size: 9px;
                }

                .asterisk_input:after {
                    content: " *";
                    color: #e32;
                    position: absolute;
                    margin: 0px 0px 0px -20px;
                    font-size: 20px;
                    padding: 0 5px 0 0


                bl_body t  {
                    xt-align: c nter;


                ooltip {
                    sition: a solute;

                    splay: n ne;

                    rder: 1 x  slid #99;

                    ckground-color: r b(255,62,62);

                    lor: w ite;

                    dding: 7 x;


                dwidth {
                    dth: 5 px;

                    dding-left: 2 x;

                    xt-align: r ght;


                ile-stats {
                    sition: r lative;

                    splay: b ock;

                    rgin-bottom: 5 x;

                    rder: 1 x  slid #4E4E4;

                    ebkit-border-radius: 1 px;

                    erflow: h dden;

                    dding-bottom: 1 x;

                    ebkit-background-clip: p dding-box;

                    oz-border-radius: 5 x;

                    oz-background-clip: p dding;

                    rder-radius: 5 x;

                    ckground-clip: p dding-box;

                    ckground: # 3879C;

                    ansition: a l 30ms  ese-in-out;

                    lor: w ite;


                ile-stats-head {
                    sition: r lative;

                    splay: b ock;

                    rgin-bottom: 1 x;

                    rder: 1 x  slid #4E4E4;

                    ebkit-border-radius: 1 px;

                    erflow: h dden;

                    dding-bottom: 0 x;

                    dding-left: 1 px;

                    dding-right: 1 px;

                    ebkit-background-clip: p dding-box;

                    oz-border-radius: 5 x;

                    oz-background-clip: p dding;

                    rder-radius: 5 x;

                    ckground-clip: p dding-box;

                    ckground: # 3879C;

                    ansition: a l 30ms  ese-in-out;

                    lor: w ite;


                _panel {
                    sition: r lative;

                    dth: 1 0%;

                    rgin-bottom: 1 px;

                    dding: 0 x  0x;

                    splay: i line-block;

                    ckground: # ff;

                    rder: 1 x  slid #6E9ED;

                    ebkit-column-break-inside: a oid;

                    oz-column-break-inside: a oid;

                    lumn-break-inside: a oid;

                    acity: 1

                    ansition: a l .s ese;


                xtwidths {
                    xt-align: r ght;

                    dth: 4 px;


                tsize {
                    nt-size: 8 x;


                blheadtr {
                    nt-size: 1 px;

                    nt-weight: 6 0;

                    sition: r lative;

                    ckground-color: # ff4fc;


                blheadtr t  {
                    xt-align: c nter;


                blbodylbl {
                    nt-size: 1 px;


                blbodytxt {
                    ign-items: b seline;

                    xt-align: r ght;

                    dding: 1 x;


                 s an {
                    ne-height: 1 px;


                dborder {
                    rder-color: i dianred;


                d-breadcrumb {
                    dth: 1 0%;

                    x-width: 1 0%;

                    dding: 0 5em  1m;

                    rgin: 1 m  ato;

                    ckground-color: t ansparent;

                    rder-radius: . em;


                d-breadcrumb:after {
                    ntent: " ;

                    splay: t ble;

                    ear: b th;


                d-breadcrumb:active {
                    rgin-bottom: - px;

                    dding-bottom: 1 x;

                    ckground-color: # 3879C; / rgb(66,151,215);*/

                d-breadcrumb l  {
                    splay: i line-block;

                    oat: l ft;

                    rgin: 0 5em  0


                media oly sreen ad (in-width: 768px) {
                    d-breadcrumb.triangle {
                         reset basic style */
                        ckground-color: r b(237,239,240);  / transparent;*/
                        dding: 0
        /* END EXTERNAL SOURCE */
    </style>
}
