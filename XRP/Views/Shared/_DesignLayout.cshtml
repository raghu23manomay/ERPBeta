<!DOCTYPE html>
<html lang="en">
<head>
    <title> - @ViewBag.Title</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="~/fon" type="image/x-icon">
    <link href="~/assets/asset/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/asset/css/style.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/asset/css/style1.css" rel="stylesheet" type="text/css" />
    <link href="~/assets/asset/css/plugins/font-awesome/css/font-awesome.css" rel="stylesheet" type="text/css">
     
</head>
 
<body>
    <nav class="navbar navbar-fixed-top">
        <div class="nav-one navbar-blue">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#"><img src="E:\Recruitee18Dec2018\Recruitee\images\erplogo.png" alt="" style="width:50px;"></a>

            </div>
            <div id="navbar" class="collapse navbar-collapse">
                
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="javascript:;"><div><i class="fa fa-plus"></i></div></a></li>
                    <li><a href="javascript:;"><div><i class="fa fa-bullhorn"></i></div></a></li>
                    <li><a href="javascript:;"><span>VS</span></a></li>
                </ul>
            </div>
        </div>
        <div class="wrapper">
            <!-- Sidebar -->
            <nav id="sidebar">
                <ul class="list-unstyled components marginTop60 paddingTop15">
                    <li><a href="#"><div><i class="fa fa-dashboard" aria-hidden="true"></i></div>Dashboard</a></li>
                    <li><a href="#"><div><i class="fa fa-gift" aria-hidden="true"></i></div>Sales</a></li>
                    <li><a href="#about"><div><i class="fa fa-shopping-basket" aria-hidden="true"></i></div>Purchase</a></li>
                    <li><a href="#contact"><div><i class="fa fa-tasks" aria-hidden="true"></i></div>Planning</a></li>
                    <li><a href="#about"><div><i class="fa fa-industry" aria-hidden="true"></i></div>Production</a></li>
                    <li><a href="#contact"><div><i class="fa  fa-bars" aria-hidden="true"></i></div>Stock</a></li>
                    <li><a href="#"><div><i class="fa fa-check" aria-hidden="true"></i></div>My Approvals</a></li>
                    <li><a href="#about"><div><i class="fa fa-cog" aria-hidden="true"></i></div>Setting</a></li>
                    <li><a href="#contact"><div><i class="fa fa-file" aria-hidden="true"></i></div>Reports</a></li>
                     

                </ul>
            </nav>
        </div>
    </nav>
    <div class="paddingRight15 marginLeft100 marginTop60">
        <div class="row">
            <div class="col-xs-12">
                <div id="enqFilter">
                    <div>
                        <ul class="list-unstyledEnqFiter components marginTop20 paddingLeft15">
                            <li><a href="../Inquiry/AllInquiry"><i class="fa fa-envelope"></i></i>   New Enquiry </a></li>
                            <li><a href="#"><i class="fa fa-behance" aria-hidden="true"></i></i>   Feasibility </a></li>
                            <li><a href="#"><i class="fa fa-quote-left" aria-hidden="true"></i>   Quotation </a></li>
                            <li><a href="#"><i class="fa fa-shopping-bag" aria-hidden="true"></i>   Purchase Orders </a></li>

                        </ul>
                    </div>
                    <div class="divTopBorder">
                        <ul class="list-unstyledEnqFiter components marginTop20 paddingLeft15">
                            <li><div></div>New Enquiry</a></li>


                        </ul>
                    </div>
                </div>
                <div class="tablecontent"> 
                     
                        @RenderBody()
                       
                </div>
            </div>
        </div>
    </div>
</body>
<script src="../assets/js/app.js"></script>
<script src="~/NewCssAndTheme/js/BackToTop.js"></script>
<script src="~/assets/js/UserAccess.js"></script>
<script>
        $(document).ready(function ()
        {
           // var userID1 = '@Request.RequestContext.HttpContext.Session["userid"]';
            var userID1=$("#hdnUserID").val();

            if (userID1== " " ||userID1== null) {
               // window.location = "../Auth/Login";
            }else {
                var userid=userID1;

            setaccesscontrol(userid,"@ViewBag.Feature","1","@ViewBag.FeatureAdd");
            if ("@Session["username"]" == "" || "@Session["username"]" == null)
            {
                @*location.href="@Url.Action("Auth", "Login")";*@
              //  window.location = "../Auth/Login";
            }
            else {
                var id = 0;
                NotificationBind(id);
                MenuBind();
            }
            }

             
        });

</script>

<script>
        function MenuBind()
        {
            $("#ul_mainstartmenu").empty();
            var userid = '@Request.RequestContext.HttpContext.Session["userid"]';
            $.ajax({
                type: "POST",
                url: "../Auth/MenuBind",
                data: JSON.stringify({ UserID: ' ' + userid + '' }),
                contentType: "application/json;charset=utf-8",
                success: function (data) {

                    var items = [];
                    for (var i = 0; i < data.length; i++) {

                        items.push('<li class="treeview"><a href="#"><i class="'+data[i].MenuIconClass+'"></i>'+data[i].MenuName+'</a><ul class="treeview-menu" id="'+data[i].MenuId+'"></ul></li>');

                    }

                    var uniqueNames = [];
                    $.each(items, function(i, el){
                        if($.inArray(el, uniqueNames) === -1)
                        {
                            uniqueNames.push(el);
                        }

                    });
                    $('#ul_mainstartmenu').append(uniqueNames.join(''));
                    $('#ul_mainstartmenu li').each(function(i)
                    {
                        var text=$(this).text();
                        for (var j = 0; j < data.length; j++) {
                            if (text==data[j].MenuName) {

                                $("#"+data[j].MenuId).append('<li><a href="../' + data[j].Controller + '/' + data[j].Action + '"><i class="icon icon-circle-o light-blue-text sm-12"></i>'+data[j].SubmenuName+'</a></li>');
                            }
                        }



                    });

                    }

            });
        }
        function NotificationBind(id) {
            $.ajax({
                type: "POST",
                url: "../Auth/NotificationBind",
                // data: params,
                data: JSON.stringify({ id: ' ' + id + '' }),
                contentType: "application/json;charset=utf-8",
                // dataType: "json",
                success: function (data) {

                    var items = [];
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].IsRead==1) {
                            items.push('<li onclick="setUnread(' + data[i].NotificationID + ')"><a href=' + data[i].ActionLink + '><i class="icon icon-data_usage text-success"></i>' + data[i].Description + '</a></li>');
                        }
                        else {
                            items.push('<li onclick="setUnread(' + data[i].NotificationID + ')"><a href=' + data[i].ActionLink + '><i class="icon icon-data_usage text-danger"></i>' + data[i].Description + '</a></li>');
                        }


                        $("#spn_notificationcount").text(data[i].Cnt);
                        $("#spn_totalnotification").text(data[i].Cnt);

                    }
                    $('#ulnotificationbind').append(items.join(''));
                },
                error: function (err) {
                    //alert('Error occured');

                }
            });
        }
        function setUnread(NotificationID)
        {
            $.ajax({
                type: "POST",
                url: "../Auth/setUnreadMsg",
                // data: params,
                data: JSON.stringify({ NotificationID: ' ' + NotificationID + '' }),
                contentType: "application/json;charset=utf-8",
                // dataType: "json",
                success: function (data) {

                },
                error: function (err) {
                    alert('Error occured');

                }
            });
        }
        function getQuotationApprovalCount() {
            $.ajax({
                type: "GET",
                url: "../Quotation/GetApprovalCount",
                success: function (data) {
                    if (data == "") {

                        $("#countQuotation").text("0");
                    } else {
                        $("#countQuotation").text(data[0].Total);
                    }
                }



            });
        }
</script>
<script>
    function getCustPOCount() {
        $.ajax({
            type: "GET",
            url: "../PurchaseOrder/GetApprovalCount",
            success: function (data) {
                $("#countCustPO").text(data);
            }
        });
    }
</script>
<script>
    function getVPOCount() {
        $.ajax({
            type: "GET",
            url: "../VendorPurchaseOrderApproval/GetApprovalCount",
            success: function (data) {

                $("#countVPO").text(data);
            }
        });
    }
</script>
<script>
    function getRMCount() {
        $.ajax({
            type: "GET",
            url: "../RMRequisitionApproval/GetApprovalCount",
            success: function (data) {
                $("#countRM").text(data);
            }
        });
    }
</script>
<script>
    function getDieCount() {
        $.ajax({
            type: "GET",
            url: "../DieRequisitionApproval/GetApprovalCount",
            success: function (data) {
                $("#countDie").text(data);
            }
        });
    }
</script>
 
</html>