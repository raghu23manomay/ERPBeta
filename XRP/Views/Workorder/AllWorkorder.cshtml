@*@model XRP.Models.Paged_ssmtbl_WorkorderModel*@
@model XRP.Models.Paged_ssmtbl_PurchaseOrderModel
@using XRP.Global;
@{
    ViewBag.Title = "AllWorkorder";
    ViewBag.Active = "Marketing";
    Layout = "~/Views/Shared/_DesignLayout.cshtml";
}
<style>
    .btnGenerateWO {
        position: absolute;
        bottom: 25px;
        right: 20px;
    }

    .btnOutsourcing {
        position: absolute;
        bottom: 25px;
        left: 20px;
    }

    .btnGenerateCuttingSlip {
        position: absolute;
        bottom: 25px;
        left: 20px;
    }
</style>
<link rel="stylesheet" href="~/assets/css/app.css">
<link href="~/Content/Validations/jquery-ui.css" rel="stylesheet" />
@using (Html.BeginForm("AllPO", "Workorder", FormMethod.Get, new { @class = "form-horizontal", role = "form", enctype = "multipart/form-data" }))
{
    @Html.ValidationSummary(true)

    <input type="hidden" id="woPOID" />
    <input type="hidden" id="hdnGrossWeight" />
    <input type="hidden" id="hdnpoid" />
    <input type="hidden" id="hdn_poidcnt" />
    <input type="hidden" id="hdnWeight" />
    <input type="hidden" id="hdnGoodsIssuedno" />
    <input type="hidden" id="hdnSectionId" />

    <div class="btn btn-warning btn-lg toast-action"
         data-title="Alert !"
         data-message="Plan Qty must be less than Balance Qty"
         data-type="success"
         data-position-class="toast-bottom-right" style="display:none" id="divAlert" align="center">

    </div>
    <fieldset>
        <style>
            .icon:hover, .trDelivery:hover {
                cursor: pointer;
            }

            /*.table-wrapper-scroll-y {
                display: block;
                max-height: 600px;
                overflow-y: auto;
                -ms-overflow-style: -ms-autohiding-scrollbar;
            }*/
        </style>

        <!-- PAGE TITLE -->
        <div class="row">
            <div class="col-md-12">

                <div class="panel panel-default">


                    <div class="container-fluid animatedParent animateOnce p-0">
                        <div class="animated fadeInUpShort">
                            <div class="row no-gutters">
                                <div class="col-md-3 white sticky" style="height:auto">
                                    <div class="sticky white">
                                        <ul class="nav nav-tabs nav-material">
                                            <li class="nav-item">

                                                <a class="nav-link p-3 active show" id="w2--tab1" data-toggle="tab" href="#w2-tab1" style="height:auto">
                                                    <input type="text" class="" id="txt_search" style="display:none;" /><br />
                                                    <i class="icon icon-document s-18 text-success"></i>Purchase Orders

                                                    <i class="icon-search" onclick="search();"></i>
                                                </a>
                                            </li>

                                        </ul>
                                    </div>
                                    @*<div class="slimScroll" style="position:relative;overflow:hidden; width:auto; height:auto">
                                        <div class="slimScroll" style="height:auto;width:auto">*@
                                    <div class="slimScroll" style="position:relative;overflow:hidden;height:initial">
                                        @*<div class="slimScroll" style="">*@

                                        <div class="tab-content " id="v-pills-tabContent">
                                            <div class="tab-pane fade show active slimScroll" id="w2-tab1" role="tabpanel"
                                                 aria-labelledby="w2-tab1">
                                                <div class="slimScroll" data-height="500">
                                                    <ul class="list-unstyled trDelivery" id="ullslistbind">

                                                        @foreach (var data in Model.ssmtbl_PurchaseOrderModel)
                                                        {

                                                            <li style="display:none" class="WoNo"><input type="hidden" value="@data.WorkorderNo1" id="hdnMaxWono" /></li>
                                                            <li style="display:none" class="WoNo"><input type="hidden" value="@data.WorkorderNo1" id="hdnwono" /></li>

                                                            <li class="media p-3 b-b has-hover liPOS" onclick="fetchPO(@data.po_id)">
                                                                <input type="hidden" value="@data.CustomerPONo" class="pono" />
                                                                <div type="hidden" value="@data.po_id" class="poID" />
                                                                <div>
                                                                    <div class="avatar avatar-md mr-3 mt-1 float-left">
                                                                        <span class="avatar-letter avatar-letter-@data.customerName.ToLower().First() avatar-md circle"></span>
                                                                    </div>
                                                                    <div class="media-body text-truncate">
                                                                        <small class="float-right">
                                                                            <span title="PO Approval Date">@data.ApprovalDate.Date.ToString("dd-MMM")</span>

                                                                            <a class="" href="#" data-toggle="dropdown"
                                                                               aria-haspopup="true" aria-expanded="false">

                                                                            </a>

                                                                        </small>
                                                                        <h6 class="mt-0 mb-1 font-weight-normal">@data.CustomerPONo </h6>

                                                                        <h6 class="font-weight-normal" sty>@data.customerName</h6>

                                                                        <small title="Die No">Die # @data.DieNumber&nbsp;</small>
                                                                        <small title="Quotation No"> | &nbsp; Quotation # @data.QuotationNo</small>
                                                                    </div>

                                                                </div>
                                                            </li>

                                                        }
                                                    </ul>
                                                </div>
                                            </div>

                                        </div>

                                    </div>
                                </div>


                                <div class="col-md-6 tab-pane animated fadeInUpShort" id="PODetailsDiv" style="height:auto" data-height="600px">
                                    <div class="">
                                        <div class="card-body slimScroll p-0" data-height="600">
                                            <div class="w-body w-scroll ">
                                                <div class="m-md-1">

                                                    <div class="card b-0 m-2">
                                                        <div class="card-body" style="height:600px; overflow: hidden; width: auto;">
                                                            <div data-target="#message1">
                                                                <span class="r-3 badge badge-primary align-self-end float-right" id="lblNatureOfWork" title="Nature Of Work">Nature Of Work</span>
                                                                <br /><br />

                                                                @*<img class="d-flex mr-3 height-50" src="~/assets/img/dummy/u1.png" alt="Generic placeholder image">*@

                                                                <div class="media">

                                                                    <div class="mr-2 float-left">
                                                                        @*<img class="d-flex mr-3 height-50" src="~/assets/img/dummy/u1.png" alt="Generic placeholder image">*@
                                                                        <i class="icon icon-note-list text-light-blue s-48"></i>
                                                                    </div>
                                                                    <div class="media-body">

                                                                        <h6 class="mt-0 mb-1 font-weight-normal" id="lblcustomerName"><label title="Customer Name"></label></h6>



                                                                        <span style="padding-bottom:0">
                                                                            <label>Purchase Order #</label>  <strong id="lblpono" class="Label"></strong> &nbsp;
                                                                            <label> | &nbsp; Qty :</label> &nbsp;<label id="lblPOQty" class="Label"></label>
                                                                            <br />

                                                                        </span>
                                                                        <small id="lblApprovalDate"></small>

                                                                        <div class="collapse my-3 show" id="message1">
                                                                            <div>
                                                                                <table>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Die :&nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblDieNo" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Part Name:&nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblPartName" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Raw Material : &nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblrawMaterial" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Section :
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblSection" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Condition Of Supply : &nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblCondOfSupply" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Cut Weight : &nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblCutwt" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Operations Involved  : &nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblOpsinvolved" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Heat Treatment : &nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblHeatTreatment" title="Heat Treatment" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                    <tr>
                                                                                        <td>
                                                                                            Hardness : &nbsp;
                                                                                        </td>
                                                                                        <td>
                                                                                            <label id="lblHardnessMin" title="Hardness Min" class="Label"></label>&nbsp;&nbsp;- &nbsp;<label id="lblHardnessMax" title="Hardness Max" class="Label"></label>
                                                                                            &nbsp;<label id="lblHardnessUnits" title="Hardness Unit" class="Label"></label>
                                                                                        </td>
                                                                                    </tr>
                                                                                </table>
                                                                            </div>

                                                                        </div>

                                                                    </div>


                                                                </div>
                                                                <div>
                                                                    @*<button type="button" value="Save" class="btn btn-primary btn-sm btnOutsourcing" id="btnGenerateOutSourcing" onclick="showWO()"><i class="icon-sign-out mr-2"></i>Outsourcing</button>*@
                                                                    <button type="button" value="Save" class="btn btn-success btn-sm btnGenerateWO" id="btnGenerateWO" onclick="showWO()"><i class="icon-input mr-2"></i> Generate WO </button>
                                                                </div>
                                                            </div>

                                                        </div>

                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                @*<div class="col-md-5 d-none d-md-block text-truncate white b-r">*@
                                @*<div class="col-md-5 d-none d-md-block bg-light b-r" data-height="600" style="overflow : hidden ; height : 600px ; ">*@
                                <div class="col-md-3 tab-pane animated fadeInUpShort" id="WODetailsDiv" style="display:none; overflow : hidden ; height:600px" data-height="600px">
                                    <div class="">
                                        <div class="card-body slimScroll p-0" data-height="600">
                                            <div class="w-body w-scroll ">

                                                <div class="m-md-0">
                                                    <!--Message Start-->
                                                    <div class="card b-0 m-2">
                                                        <div class="card-body" style="height:600px">
                                                            @*<div class="form-row mt-1 m-0">*@
                                                            <div class="form-row">
                                                                <div class="form-group col-12 m-0 float-right">
                                                                    <span class="col-form-label s-12 float-right">
                                                                        WO # <strong id="lblWorkorderno" class="Label">  </strong>
                                                                    </span>
                                                                </div>
                                                                @*<i class="s-24 icon-file-o d-flex mr-3 height-50"></i>*@
                                                                <div class="form-group col-12 m-0">
                                                                    <h6 class="mt-0 font-weight-normal" id="lblcustomerName1"><label title="Customer Name"></label></h6>
                                                                    @*<strong id="lblcustomerName1"></strong>*@
                                                                    <span>
                                                                        <label>PO # </label>&nbsp;<strong id="lblpono1" class="Label"></strong>
                                                                    </span>
                                                                    <div class="p-0">
                                                                        <table>
                                                                            <tr>
                                                                                <td>
                                                                                    Die #&nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <label id="lblDieNo1" class="Label"></label>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>
                                                                                    PO Quantity : &nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <label id="txtPoQty" class="Label"></label>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>
                                                                                    Section : &nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <div class="col-sm-12 pl-0" style="display:none;" id="selectSection">

                                                                                        <select class="" id="drpSection" name="Section[]">
                                                                                            <option>Select</option>
                                                                                        </select>
                                                                                    </div>
                                                                                    <span id="lblSection1" class="Label" onclick="javascript:OprInvHidewShow();"></span>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>
                                                                                    Cut Weight :&nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <label id="lblCutwt1" class="Label"></label>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>


                                                                                    Hammer Required : &nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <label id="lblHammerReq" class="Label"></label>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>
                                                                                    Cut Length : &nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <label id="lblCutLength" class="Label"></label>
                                                                                </td>
                                                                            </tr>
                                                                            <tr>
                                                                                <td>
                                                                                    Heat Code : &nbsp;
                                                                                </td>
                                                                                <td>
                                                                                    <label id="lblHeatCode" class="Label"></label>
                                                                                </td>
                                                                            </tr>
                                                                        </table>
                                                                    </div>
                                                                    <div class="form-row">

                                                                        <div class="form-group col-12 m-0" id="divbtnGenerateReq">
                                                                            <i class="float-left"><label style="font-size:11px">RM Availability (Tonne) :</label>&nbsp;<label id="RMAvailability" style="font-size:11px" class="Label"></label></i>
                                                                            <i class="float-left" id="iRMAvailabilitysts">&nbsp;(<label id="RMAvailabilitysts" style="font-size:11px" class="Label"></label>)</i>
                                                                            <button type="button" value="Save" class="btn btn-success btn-xs float-right" id="btnGenerateReq" href="#modalGenerateRequisition" data-toggle="modal" data-target="#modalGenerateRequisition" title="Generate Raw Material Requisition"><i class="icon-input"></i>  </button>

                                                                        </div>
                                                                        <div class="form-group col-12 m-0" id="divbtnGenerateDieReq">
                                                                            <i class="float-left"><label style="font-size:11px">Die Availability :</label>&nbsp;<label id="DieAvailability" style="font-size:11px" class="Label"></label></i>
                                                                            <button type="button" value="Save" class="btn btn-primary btn-xs float-right" id="btnGenerateDieReq" disabled href="#modalGenerateDieRequisition" data-toggle="modal" data-target="#modalGenerateDieRequisition" title="Generate Die Requisition"><i class="icon-input"></i>  </button>

                                                                        </div>
                                                                    </div>
                                                                    <div class="form-row">
                                                                        <div class="form-group col-6 m-0">
                                                                            <label class="col-form-label s-12">Cutting:</label>
                                                                            <select class="form-control r-0 light s-12" id="drpCuttingMc">
                                                                                <option>Select</option>

                                                                            </select>

                                                                        </div>


                                                                        <div class="form-group col-6 m-0">

                                                                            <label class="col-form-label s-12">Forging:</label>
                                                                            <select class="form-control r-0 light s-12" id="drpForgingMc">
                                                                                <option>Select</option>
                                                                            </select>

                                                                        </div>
                                                                    </div>
                                                                    <div class="form-row">

                                                                        <div class="form-group col-6 m-0">
                                                                            <label for="txtTargetDate" class="col-form-label s-12">  Target Date:</label>
                                                                            <input id="txtTargetDate" class="date-time-picker form-control r-0 light s-12 " type="text" readonly="readonly">
                                                                            <i class="float-left"><label style="font-size:11px">Dispatched Qty:</label>&nbsp;<label id="lblTotalDispatchQty" style="font-size:11px" class="Label"></label></i>
                                                                        </div>

                                                                        <div class="form-group col-6 m-0">
                                                                            <label for="txtPlanQty" class="col-form-label s-12">Plan Qty:</label>
                                                                            <input id="txtPlanQty" class="form-control r-0 light s-12 Float-Number" type="text">
                                                                            @*<input id="txtPlanQty" class="form-control r-0 light s-12 Float-Number" type="text" onfocusout='isGreaterThanPOQty(this)'>*@
                                                                            @*<input id="txtPlanQty" class="form-control r-0 light s-12 Float-Number" type="text" oninput="isGreaterThanPOQty()">*@
                                                                            <i class="float-right"><label style="font-size:11px">Balance Qty:</label>&nbsp;<label id="lblBalancedQty" style="font-size:11px" class="Label"></label></i>
                                                                        </div>

                                                                    </div>


                                                                </div>

                                                                <div class="card-body" id="div_gpo">
                                                                    <div class="float-left">
                                                                        @*<button type="button" value="Save" class="btn btn-primary btn-default btn-sm btnGenerateCuttingSlip" id="btn_Modal" onclick="close()"><i class="icon-save mr-2"></i> Cutting Slip </button>*@
                                                                        <button type="button" value="Save" class="btn btn-primary btn-sm float-right btnGenerateCuttingSlip" id="btn_Modal" href="#modalCuttingSlip" data-toggle="modal" data-target="#modalCuttingSlip" title="Generate Cutting Slip" onclick="getCuttingSlipNo()"><i class="icon-input"></i> Cutting Slip </button>
                                                                    </div>
                                                                    <div class="float-right">
                                                                        <button type="button" value="Save" class="btn btn-primary btn-default btn-sm btnGenerateWO" id="btn_Save1" onclick="generatewo()"><i class="icon-save mr-2"></i> Save </button>
                                                                        @*<button type="button" value="Save" class="btn btn-primary btn-xs float-right" id="btnGenerateDieReq" href="#modalGenerateDieRequisition" data-toggle="modal" data-target="#modalGenerateDieRequisition" title="Generate Die Requisition"><i class="icon-input"></i>  </button>*@

                                                                    </div>

                                                                </div>

                                                            </div>

                                                        </div>

                                                    </div>
                                                </div>


                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>

                        @* Modal POP Up *@
                        <div class="modal fade" id="modalGenerateRequisition" tabindex="-1" role="dialog" aria-labelledby="modalGenerateRequisition" aria-hidden="true" style="display:none;">
                            <div class="modal-dialog modal-md" role="document">
                                <div class="modal-content b-0">
                                    <div class="modal-header r-0 bg-primary">
                                        <h6 class="modal-title text-white" id="exampleModalLabel">Raw Material Requisition</h6>
                                        <a href="#" data-dismiss="modal" aria-label="Close" class="paper-nav-toggle paper-nav-white active"><i></i></a>
                                    </div>
                                    <div class="modal-body no-p no-b">
                                        <div class="card-body">
                                            <form class="needs-validation" novalidate="">
                                                <div class="form-row">
                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustom01">Requisition Type</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtRequisitionType" value="Raw Material" readonly="readonly">


                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustom02">Customer name</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtCustomerName" readonly="readonly">

                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustomUsername">Part Name</label>
                                                        <div class="input-group">

                                                            <input type="text" class="form-control r-0 light s-12" id="txtRMPartName" readonly="readonly">

                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="form-row">

                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustom04">Raw Material</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtRMRawMaterial" readonly="readonly">

                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustom05">Section</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtRMSection" readonly="readonly">

                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustom03">Quantity (Pieces)</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtRMQuantity">

                                                    </div>
                                                </div>
                                                @*<div class="form-row">
                                                        <div class="col-md-12 mb-3">
                                                            <label for="validationCustom03">Part Description</label>

                                                            <textarea id="txtPartDescription" class="form-control r-0 light s-12 "></textarea>
                                                        </div>
                                                    </div>*@
                                                <div class="form-row">
                                                    <div class="col-md-12 mb-3">
                                                        <label for="validationCustom03">Remark</label>

                                                        <textarea id="txtRMRemark" class="form-control r-0 light s-12 "></textarea>
                                                    </div>
                                                </div>

                                            </form>


                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-primary l-s-1 s-12 text-uppercase" onclick="SendRequisition();" type="button">
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="modalGenerateDieRequisition" tabindex="-1" role="dialog" aria-labelledby="modalGenerateDieRequisition" aria-hidden="true" style="display:none;">
                            <div class="modal-dialog modal-md" role="document">
                                <div class="modal-content b-0">
                                    <div class="modal-header r-0 bg-primary">
                                        <h6 class="modal-title text-white" id="exampleModalLabel">Die Requisition</h6>
                                        <a href="#" data-dismiss="modal" aria-label="Close" class="paper-nav-toggle paper-nav-white active"><i></i></a>
                                    </div>
                                    <div class="modal-body no-p no-b">
                                        <div class="card-body">
                                            <form class="needs-validation" novalidate="">
                                                @*<div class="form-row">
                                                        <div class="col-md-4 mb-3">
                                                            <label for="validationCustom01">Requisition Type</label>
                                                            <input type="text" class="form-control r-0 light s-12" id="txtRequisitionType" value="Raw Material" readonly="readonly">


                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label for="validationCustom02">Customer name</label>
                                                            <input type="text" class="form-control r-0 light s-12" id="txtCustomerName">

                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label for="validationCustomUsername">Part Name</label>
                                                            <div class="input-group">

                                                                <input type="text" class="form-control r-0 light s-12" id="txtPartName">

                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="form-row">

                                                        <div class="col-md-4 mb-3">
                                                            <label for="validationCustom04">Raw Material</label>
                                                            <input type="text" class="form-control r-0 light s-12" id="txtRawMaterial">

                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label for="validationCustom05">Section</label>
                                                            <input type="text" class="form-control r-0 light s-12" id="txtSection">

                                                        </div>
                                                        <div class="col-md-4 mb-3">
                                                            <label for="validationCustom03">Quantity</label>
                                                            <input type="text" class="form-control r-0 light s-12" id="txtQuantity">

                                                        </div>
                                                    </div>*@
                                                <div class="form-row">
                                                    <div class="col-md-12 mb-3">
                                                        <label for="txtDieDescription">Description</label>

                                                        <textarea id="txtDieDescription" class="form-control r-0 light s-12 "></textarea>
                                                    </div>
                                                </div>
                                                <div class="form-row">
                                                    <div class="col-md-12 mb-3">
                                                        <label for="txtDieRemark">Remark</label>

                                                        <textarea id="txtDieRemark" class="form-control r-0 light s-12 "></textarea>
                                                    </div>
                                                </div>

                                            </form>


                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-primary l-s-1 s-12 text-uppercase" onclick="SendDieRequisition();">
                                            Send
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="modal fade" id="modalCuttingSlip" tabindex="-1" role="dialog" aria-labelledby="modalCuttingSlip" aria-hidden="true" style="display:none;">
                            <div class="modal-dialog modal-md" role="document">
                                <div class="modal-content b-0">
                                    <div class="modal-header r-0 bg-primary">
                                        <h6 class="modal-title text-white" id="exampleModalLabel">
                                            Cutting Slip
                                            <span class="float-right" style="color:white; padding-right:50px;">
                                                # <strong id="lblCuttingSlipNo" style="color:white">

                                                </strong>
                                            </span>
                                        </h6>

                                        <a href="#" data-dismiss="modal" aria-label="Close" class="paper-nav-toggle paper-nav-white active"><i></i></a>
                                    </div>
                                    <div class="modal-body no-p no-b">
                                        <div class="card-body">
                                            <div class="form-group col-12 m-0">
                                                @*<span class="float-right">
                                                        Cutting Slip # <strong id="lblCuttingSlipNo">
                                                        CS-00001
                                                        </strong>
                                                    </span><br />*@
                                                <div>

                                                    <span class="float-right">
                                                        WorkOrder # <strong id="lblCutWorkorderno"></strong>
                                                    </span><br />
                                                    <div class="float-left">
                                                        <img class="d-flex mr-3 height-50" src="~/assets/img/dummy/u1.png" alt="Generic placeholder image">
                                                    </div>
                                                    <div class="media-body text-truncate">


                                                        <span><strong><label id="lblCutcustomerName"></label></strong></span>
                                                        <br>
                                                        <small style="color:grey" title="PO No"><label id="lblCutPONo"> </label> &nbsp;</small>
                                                        <small style="color:grey" title="Section">| &nbsp;<label id="lblCutSection"></label>&nbsp;</small>
                                                        <small style="color:grey" title="Cut Weight"> | &nbsp; <label id="lblCutCTWt"></label> &nbsp;</small>
                                                        <small style="color:grey" title="Die No"> | &nbsp; <label id="lblCutDieNo">369852</label> &nbsp;</small>
                                                        <br />
                                                        <small style="color:grey" title="PO Quantity"> <label id="lblCutPOQty"></label> &nbsp;</small>
                                                        <small style="color:grey" title="Hammer Required"> | &nbsp; <label id="lblCutHammerReq"></label> &nbsp;</small>
                                                        <small style="color:grey" title="Cut Length"> | &nbsp; <label id="lblCutCutLength"></label> &nbsp;</small>

                                                        <small style="color:grey" title="RM Grade"> | &nbsp; <label id="lblCutRMGrade"></label> &nbsp;</small>
                                                        <small style="color:grey" title="Heat Code"> | &nbsp; <label id="lblCutHeatCode"></label> &nbsp;</small>
                                                    </div>

                                                </div>

                                            </div>
                                            <br />
                                            @*<form class="needs-validation" novalidate="">*@
                                            @*<div class="form-row">
                                                    <div class="col-md-3 mb-3">
                                                        <label for="lblCutRMGrade">RM Grade:</label>
                                                        <label id="lblCutRMGrade"></label>


                                                    </div>
                                                    <div class="col-md-3 mb-3">
                                                        <label for="lblCutSection">Section:</label>
                                                        <label id="lblCutSection"></label>

                                                    </div>
                                                    <div class="col-md-3 mb-3">
                                                        <label for="lblCutInternalCutWt" >Cut Weight:</label>
                                                        <label id="lblCutInternalCutWt"></label>

                                                    </div>

                                                    <div class="col-md-3 mb-3">
                                                        <label for="lblCutlength">Cut Length:</label>

                                                        <label id="lblCutlength"></label>



                                                    </div>
                                                </div>*@
                                            <div class="form-row">
                                                <div class="col-md-6 mb-3">
                                                    <label for="txtCutQuantity">Quantity:</label>
                                                    <input type="text" class="form-control r-0 light s-12" id="txtCutQuantity" oninput="calculateTotalWt()">

                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label for="txtCutTotalWt">Total Weight (Kg):</label>
                                                    <input type="text" class="Label" id="txtCutTotalWt" readonly="readonly" style="border:none">

                                                </div>
                                                @*<div class="col-md-4 mb-3">
                                                        <label for="validationCustom05">Section</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtSection">

                                                    </div>
                                                    <div class="col-md-4 mb-3">
                                                        <label for="validationCustom03">Quantity</label>
                                                        <input type="text" class="form-control r-0 light s-12" id="txtQuantity">

                                                    </div>*@
                                            </div>
                                            @*<div class="form-row">
                                                    <div class="col-md-12 mb-3">
                                                        <label for="validationCustom03">Part Description</label>

                                                        <textarea id="txtPartDescription" class="form-control r-0 light s-12 "></textarea>
                                                    </div>
                                                </div>
                                                <div class="form-row">
                                                    <div class="col-md-12 mb-3">
                                                        <label for="validationCustom03">Remark</label>

                                                        <textarea id="txtRemark" class="form-control r-0 light s-12 "></textarea>
                                                    </div>
                                                </div>*@

                                            @*</form>*@


                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button class="btn btn-primary l-s-1 s-12 text-uppercase" onclick="generateGISNo();">
                                            Send
                                        </button>

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </fieldset>

    <script type="text/javascript" src="~/Scripts/jquery-1.10.2.js"></script>
    <script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <script src="~/Content/Validations/JqueryUi.js"></script>

    <script type="text/javascript">
        var $j = jQuery.noConflict(true);
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            bindSection();
            $("#PODetailsDiv").hide();
            $("#WODetailsDiv").hide();
            document.body.style.overflow = 'hidden';
            $(function () {
                $('.date-time-picker').datetimepicker({
                    format: 'd/m/Y',
                    timepicker: false,

                });
            });
        });
    </script>
    <script>
        function OprInvHidewShow() {
            //$("#drpSection").select({
            //    placeholder:"Select",
            //});
            $("#lblSection1").hide();
            $("#selectSection").show();

        }
        function bindSection(){
            var stringArray = @Html.Raw(Json.Encode(@ViewData["Section"]));
            $.each(stringArray, function (i, data) { // bind the dropdown list using json result
                $('<option>',
                   {
                       value: data.Value,
                       text: data.Text
                   }).html(data.BindType).appendTo("#drpSection");
            });
        }
    </script>
    <script>
        function checkpoidstatus(poid) {
            $.ajax
                                        ({
                                            type: "POST",
                                            url: "../Workorder/checkpoidstatus",
                                            data: JSON.stringify({
                                                poid: '' + poid + ''
                                            }),
                                            contentType: "application/json;charset=utf-8",
                                            //dataType: "json",
                                            success: function (status) {

                                                if (status != "") {
                                                    if ((status[0].Status == 'Pending For Approval') || (status[0].Status == 'Approved') || (status[0].Status == 'Rejected') || (status[0].Status == 'SendPo') || (status[0].Status == 'Sent For RM Testing')) {
                                                        //$j("#modalGenerateRequisition").closeModal();
                                                        if (status[0].Status == 'Pending For Approval') {
                                                            $j("#RMAvailabilitysts").text("Pending For Approval");
                                                        }
                                                        if (status[0].Status == 'Approved') {
                                                            $j("#RMAvailabilitysts").text("Requisition Sent Approved");
                                                        }
                                                        if (status[0].Status == 'Rejected') {
                                                            $j("#RMAvailabilitysts").text("Requisition Sent Rejected");
                                                        }
                                                        if (status[0].Status == 'SendPo') {
                                                            $j("#RMAvailabilitysts").text("Vendor PO Sent");
                                                        }
                                                        if (status[0].Status == 'Sent For RM Testing') {
                                                            $j("#RMAvailabilitysts").text("Sent For RM Testing");
                                                            $j("#iRMAvailabilitysts").show();
                                                        }
                                                        $j("#btnGenerateReq").hide();
                                                        $j("#hdn_poidcnt").val("1");
                                                    }
                                                    else {

                                                        $j("#btnGenerateReq").show();
                                                        $j("#hdn_poidcnt").val("0");
                                                    }

                                                }
                                                else {
                                                    // $j("#btnGenerateReq").show();
                                                    $j("#hdn_poidcnt").val("0");
                                                }

                                            },
                                            error: function (err) {

                                            }
                                        });
        }
        function closeDieModal() {

            $('#modalGenerateDieRequisition').modal('hide');
        }
        function closePopup() {

            $('#modalGenerateRequisition').modal('hide');

        }
    </script>

    <script>
        //function isGreaterThanPOQty(planQty) {
        //    var poQty = $("#txtPoQty").text();
        //    //var planQty = parseFloat($("#txtPlanQty").val());
        //    var dispatchQty = parseFloat($("#lblTotalDispatchQty").text());
        //    var balanceQty = parseFloat($("#lblBalancedQty").text());
        //    var availableQty = isNaN($("#RMAvailability").text()) == true ? 0: parseFloat($("#RMAvailability").text());
        //    alert(availableQty);
        //    //return false;
        //    if (poQty == balanceQty) {
        //        balanceQty = 0;
        //    } else {
        //        balanceQty = parseFloat($("#lblBalancedQty").text());
        //    }
        //    var totalPlanableQty = poQty - parseFloat(dispatchQty + balanceQty);
        //    //alert(totalPlanableQty);
        //  //  if (planQty > totalPlanableQty) {
        //    if (planQty > availableQty) {
        //        //alert("Plan Qty must be less than Balance Qty");
        //        $("#divAlert").click();
        //        $("#txtPlanQty").val("");
        //        document.getElementById("txtPlanQty").style.borderColor = "red";
        //        return false;
        //    } else {
        //        document.getElementById("txtPlanQty").style.borderColor = "";
        //    }
        //}
    </script>
    <script>
        function SendRequisition() {
            var userID=$("#hdnUserID").val();
            var reqType = $("#txtRequisitionType").val();
            var customerName = $("#txtCustomerName").val();
            var partName = $("#txtRMPartName").val();
            var rawMaterial = $("#txtRMRawMaterial").val();
            var section = $("#txtRMSection").val();
            var quantity = $("#txtRMQuantity").val();
            if (quantity=="") {
                alert("Please Enter Quantity (Pcs) !!");
                return false;
            }
            var DieDescription = "0";
            var partNumber="";
            var partDescription = $("#txtPartDescription").val();
            var workorderNo = $("#hdnwono").val();
            var remark = $("#txtRMRemark").val();
            var GrossWeight = $("#hdnGrossWeight").val();
            var totalWt = quantity * GrossWeight;
            var poid = $("#hdnpoid").val();
            var department="0";
            //alert(workorderNo);
            $.ajax
                                         ({
                                             type: "POST",
                                             url: "../Workorder/SendRequisition",
                                             data: JSON.stringify({
                                                 ReqType: ' ' + reqType + '', CustomerName: ' ' + customerName + '', 
                                                 PartName: ' ' + partName + '',partNumber: ' ' + partNumber + '', 
                                                 RawMaterial: ' ' + rawMaterial + '', TotalWt: '' + totalWt + '',
                                                 Section: ' ' + section + '', Quantity: ' ' + quantity + '',
                                                 DieDescription:''+DieDescription+'', PartDescription: ' ' + partDescription + '', 
                                                 WorkorderNo: '' + workorderNo + '', Remark: '' + remark + ''
                                                 , poid: '' + poid + '', userID:''+userID+'',Department:''+department+''
                                             }),
                                             contentType: "application/json;charset=utf-8",
                                             //dataType: "json",
                                             success: function (rfqid) {
                                                 if (rfqid!="0") {
                                                     //$j("#modalGenerateRequisition").closeModal();
                                                     $j("#RMAvailabilitysts").text("Requisition Sent");
                                                     $j("#btnGenerateReq").hide();
                                                     insertRequisitionDetails(rfqid, rawMaterial, section, quantity, totalWt);
                                                     // getRawMaterialAvailability(data[0].RawMaterial, data[0].Section);
                                                 }else {
                                                     alert("Error Occured While Sending  Requisition !!");
                                                     return false;
                                                 }
                                             },
                                             error: function (err) {
                                                 alert("Error Occured While Sending  Requisition !!");
                                                 return false;
                                             }
                                         });
        }
        function insertRequisitionDetails(rfqid, rawMaterial, section, quantity, totalWt) {
            var Req="InsertRM";
            $.ajax
                                       ({
                                           type: "POST",
                                           url: "../Workorder/insertRequisitionDetails",
                                           data: JSON.stringify({
                                               RFQId: ' ' + rfqid + '', RawMaterial: ' ' + rawMaterial + '',
                                               Section: ' ' + section + '', Quantity: ' ' + quantity + '', TotalWt: ' ' + totalWt + '',
                                               Req:''+Req+''
                                           }),
                                           contentType: "application/json;charset=utf-8",
                                           //dataType: "json",
                                           success: function (data) {
                                               closePopup();
                                               alert("Requisition Sent Successfully!");
                                           },
                                           error: function (err) {
                                               alert("Error Occured While Sending  Requisition !!");
                                               return false;
                                           }
                                       });

        }
        function SendDieRequisition() {
            var dieDescription = $("#txtDieDescription").val();
            var dieRemark = $("#txtDieRemark").val();
            var dieNo = $("#lblDieNo1").text();
            var workorderNo = $("#lblWorkorderno").text();
            $.ajax
                                         ({
                                             type: "POST",
                                             url: "../Workorder/SendDieRequisition",
                                             data: JSON.stringify({
                                                 DieDescription: ' ' + dieDescription + '', DieRemark: ' ' + dieRemark + '',
                                                 WorkorderNo: ' ' + workorderNo + '', DieNo: ' ' + dieNo + ''
                                             }),
                                             contentType: "application/json;charset=utf-8",
                                             //dataType: "json",
                                             success: function (data) {
                                                 $j("#DieAvailability").text("Requisition Sent");
                                                 $j("#btnGenerateDieReq").hide();
                                                 closeDieModal();
                                                 alert(data);

                                                 // getRawMaterialAvailability(data[0].RawMaterial, data[0].Section);
                                             },
                                             error: function (err) {

                                             }
                                         });
        }
    </script>
    <script>
        function closeModal() {
            var targetDate = $("#txtTargetDate").val();
            var planQty = $("#txtPlanQty").val();
            if (targetDate == "") {
                alert("Please select Target Date");
                return false;
            }
            if (planQty == "") {
                alert("Please enter Plan Quantity");
                return false;
            }
            $('#modalCuttingSlip').modal('show');
            $(document).mouseup(function (e) {
                var popup = $("#modalCuttingSlip");

                if (popup.is(e.target) && popup.has(e.target).length == 0) {
                    generatewo();
                }
            });
        }

        function generatewo() {
            var createdBy=$("#hdnUserID").val();
            var section = $("#hdnSectionId").val();
            var section1 = $("#drpSection").val();
            if (section1!='Select') {
                section = $("#drpSection").val();
            }else {
                section = $("#hdnSectionId").val();
            }
            var workorderNo = $("#hdnwono").val();
            var customerName = $("#lblcustomerName1").text();
            var poNumber = $("#lblpono1").text();
            var dieNo = $("#lblDieNo1").text();
            var rawMaterial = $("#lblrawMaterial").text();
            var heatcode = $("#txtHeatCode").val();
            //var section = $("#lblSection1").text();
            var cutLength = $("#txtCutLength").val();
            var dateOfIssue = $("#txtDateOfIssue").val();
            var targetDate = $("#txtTargetDate").val();
            var hammerNo = $("#lblHammerReq").text();
            var dieSts = $("#txtDieSts").val();
            var dieLife = $("#txtDieLife").val();
            var cutWt = $("#lblCutwt1").text();
            var poQty = $("#txtPoQty").text();
            var productionStartDate = $("#txtProduStartDate").val();
            var planQty = $("#txtPlanQty").val();

            var availableRM = $("#RMAvailability").text();

            if (availableRM == 'No') {
                availableRM = 0;
            } else {
                availableRM = $("#RMAvailability").text();
            }


            var quantity = $("#txtQuantity").val();
            var reqType = $("#txtRequisitionType").val();
            var partName = $("#txtPartName").val();
            var partDescription = $("#txtPartDescription").val();
            var remark = $("#txtRemark").val();
            var woPOID = $("#woPOID").val();
            var cutLength = $("#lblCutLength").text();
            //if (heatcode == "") {
            //    alert("Please enter Heatcode");
            //    return false;
            //}
            //if (cutLength == "") {
            //    alert("Please enter Cut Length");
            //    return false;
            //}
            var CuttingMc = $("#drpCuttingMc").val();
            var ForgingMc = $("#drpForgingMc").val();

            if (CuttingMc == "Select") {
                alert("Please select Cutting Machine");
                return false;
            }
            if (ForgingMc == "Select") {
                alert("Please select Forging Machine");
                return false;
            }
            if (dateOfIssue == "") {
                alert("Please select Date Of Issue");
                return false;
            }
            //if (targetDate == "") {
            //    alert("Please select Target Date");
            //    return false;
            //}
            //if (hammerNo == "") {
            //    alert("Please select Hammer No");
            //    return false;
            //}
            //if (dieSts == "") {
            //    alert("Please enter Die Status");
            //    return false;
            //}
            //if (dieLife == "") {
            //    alert("Please enter Die Life");
            //    return false;
            //}

            //if (productionStartDate == "") {
            //    alert("Please select Production Start Date");
            //    return false;
            //}

            if (planQty == "") {
                alert("Please enter Plan Quantity");
                return false;
            }

            $("#lblCutRMGrade").text(rawMaterial);
            $("#lblCutSection").text(section);
            $("#lblCutInternalCutWt").text(cutWt);
            $("#lblCutlength").text(cutLength);
            $("#txtCutTotalWt").val(cutLength);
            var GrossWt = $("#hdnGrossWeight").val();
            // console.log(GrossWt);
            $("#hdnWeight").val(parseFloat(planQty * GrossWt).toFixed(2));
            var weight = $("#hdnWeight").val();
            //console.log(weight);

            $.ajax({

                type: "POST",
                url: "../Workorder/GenerateWorkorder",
                data: JSON.stringify({
                    workorderNo: ' ' + workorderNo + ' ', customerName: ' ' + customerName + ' ', poNumber: ' ' + poNumber + ' ',
                    dieNo: ' ' + dieNo + ' ', rawMaterial: ' ' + rawMaterial + ' ', heatcode: ' ' + heatcode + ' ', section: ' ' + section + ' ',
                    cutLength: ' ' + cutLength + ' ', dateOfIssue: ' ' + dateOfIssue + ' ', targetDate: ' ' + targetDate + ' ',
                    hammerNo: ' ' + hammerNo + ' ', dieSts: ' ' + dieSts + ' ', dieLife: ' ' + dieLife + ' ', cutWt: ' ' + cutWt + ' ', poQty: ' ' + poQty + ' ', productionStartDate: ' ' + productionStartDate + ' ', planQty: ' ' + planQty + ' ',
                    availableRM: ' ' + availableRM + ' ', quantity: ' ' + quantity + ' ',
                    reqType: ' ' + reqType + ' ', partName: ' ' + partName + ' ', partDescription: ' ' + partDescription + ' ', remark: ' ' + remark + ' ', woPOID: ' ' + woPOID + ' '
                    , CuttingMc: ' ' + CuttingMc + ' ', ForgingMc: ' ' + ForgingMc + ' ', weight: '' + weight + ' ',createdBy: ' '+createdBy+''
                }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    alert(data);
                    //location.href = "../Workorder/AllPO";
                    //  location.href="@Url.Action("AllPO", "Workorder")";
                },
                error: function (err) {
                    // alert('Error occured');
                }
            });

        }

    </script>
    <script>
        function generateGISNo() {
            var ID = "0";
            $.ajax
                                   ({
                                       type: "POST",
                                       url: "../GoodsIssued/GetMaxGoodsIssuedNo",
                                       data: JSON.stringify({ ID: ' ' + ID + '' }),
                                       contentType: "application/json;charset=utf-8",
                                       //dataType: "json",
                                       success: function (data) {
                                           $("#hdnGoodsIssuedno").val(data);
                                           generateCuttingSlip();
                                       },
                                       error: function (err) {

                                       }
                                   });

        }
    </script>
    <script>
        function generateCuttingSlip() {

            var workorderNo = $("#hdnwono").val();
            var goodsIssuedno = $("#hdnGoodsIssuedno").val();

            var quantity = $("#txtCutQuantity").val();
            var totalWeight = $("#txtCutTotalWt").val();
            var CtSlipNo = $("#lblCuttingSlipNo").text();
            if (quantity == "") {
                alert("Please enter quantity");
                return false;
            }
            $.ajax({

                type: "POST",
                url: "../Cutting/GenerateCuttingSlip",
                data: JSON.stringify({
                    workorderNo: ' ' + workorderNo + ' ', quantity: ' ' + quantity + ' ', totalWeight: ' ' + totalWeight + ' ',
                    CtSlipNo: ' ' + CtSlipNo + ' ', goodsIssuedno: '' + goodsIssuedno + ''
                }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    alert("Cutting Slip Generated Successfully");
                    location.href = '@Url.Action("AllPO", "Workorder")';
                },
                error: function (err) {
                    // alert('Error occured');
                }
            });
        }
    </script>
    <script>
        function calculateTotalWt() {
            var qty = parseFloat($("#txtCutQuantity").val());
            var ctwt = parseFloat($("#lblCutCTWt").text());
            var totalWt = parseFloat(qty * ctwt).toFixed(2);
            $("#txtCutTotalWt").val(parseFloat(totalWt).toFixed(2));
        }
    </script>
    <script>
        function getCuttingSlipNo() {
            var wono=$j('#lblWorkorderno').text();
            $j('#lblCutWorkorderno').text(wono);
            var section=$("#drpSection :selected").text();
            if (section != 'Select') {
                $j('#lblCutSection').text(section);
            }else{

            }
            var ID = "0";
            $.ajax
                                   ({
                                       type: "POST",
                                       url: "../Cutting/GetMaxCuttingSlipNo",
                                       data: JSON.stringify({ ID: ' ' + ID + '' }),
                                       contentType: "application/json;charset=utf-8",
                                       //dataType: "json",
                                       success: function (data) {
                                           $("#lblCuttingSlipNo").text(data);
                                       },
                                       error: function (err) {

                                       }
                                   });

        }
    </script>
    <script>
        function showWO() {
            $("#lblSection1").show();
            $("#selectSection").hide();
            $("#drpSection").val("Select");
            $("#txtTargetDate").val("");
            $("#txtPlanQty").val("");
            $("#WODetailsDiv").toggle();
            var POID = $("#woPOID").val();
            checkNUpdateWOStatus(POID);



        }
        $(".liPOS").click(function () {

            $(this).addClass("media p-3 b-b has-hover light border-left");
            $(this).siblings().removeClass("media p-3 b-b has-hover light border-left");
            $(this).siblings().addClass("media p-3 b-b has-hover");
        });

    </script>
    <script>
        function checkNUpdateWOStatus(POID) {
            $.ajax
                                   ({
                                       type: "POST",
                                       url: "../Workorder/updateWOStatus",
                                       data: JSON.stringify({ POID: ' ' + POID + '' }),
                                       contentType: "application/json;charset=utf-8",
                                       //dataType: "json",
                                       success: function (data) {
                                           if (data=="") {
                                               $("#btn_Save1").prop('disabled', false);
                                               var maxWONo=$("#hdnMaxWono").val();
                                               $("#lblWorkorderno").text(maxWONo);
                                               $("#hdnwono").text(maxWONo);
                                               $("#btn_Modal").prop('disabled', true);
                                           }else{
                                               //alert(data[0].Status);
                                               //alert(data[0].WOStatus);
                                               if (data[0].WOStatus == 'false') {

                                               } else {
                                                   if (data[0].Status == '3') {
                                                       OprInvHidewShow();
                                                       $("#drpCuttingMc").val(data[0].CuttingMachineID);
                                                       $("#drpForgingMc").val(data[0].ForgingMachineID);
                                                       $("#txtTargetDate").val(jsondateformatconvert1(data[0].TargetDate));
                                                       $("#txtPlanQty").val(data[0].PlanQty);
                                                       $("#lblBalancedQty").text(data[0].BalanceQty);
                                                       $("#lblTotalDispatchQty").text(data[0].Dispatchqty);
                                                       $("#hdnwono").val(data[0].WorkorderNo);
                                                       $("#lblWorkorderno").text(data[0].WorkorderNo);
                                                       $("#btn_Save1").prop('disabled', true);
                                                       $("#btn_Modal").prop('disabled', false);
                                                       $("#drpSection").val(data[0].Section);
                                                   } else {
                                                       OprInvHidewShow();
                                                       $("#drpCuttingMc").val(data[0].CuttingMachineID);
                                                       $("#drpForgingMc").val(data[0].ForgingMachineID);
                                                       $("#txtTargetDate").val(jsondateformatconvert1(data[0].TargetDate));
                                                       $("#txtPlanQty").val(data[0].PlanQty);
                                                       $("#lblBalancedQty").text(data[0].BalanceQty);
                                                       $("#lblTotalDispatchQty").text(data[0].Dispatchqty);
                                                       $("#hdnwono").val(data[0].WorkorderNo);
                                                       $("#lblWorkorderno").text(data[0].WorkorderNo);
                                                       $("#drpSection").val(data[0].Section);
                                                       //$("#btn_Save1").prop('disabled', false);
                                                       //$("#btn_Modal").prop('disabled', false);
                                                   }
                                               }
                                           }
                                       },
                                       error: function (err) {

                                       }
                                   });

        }
    </script>
    <script>
        function fetchPO(poID) {

            $("#hdnpoid").val(poID);

            var wono = $("#hdnwono").val();
            $("#PODetailsDiv").show();
            $("#WODetailsDiv").hide();
            //var customerName = $(el).siblings("div").val();
            $.ajax
                                    ({
                                        type: "POST",
                                        url: "../Workorder/GetWoDataByPOID",
                                        data: JSON.stringify({ poID: ' ' + poID + '' }),
                                        contentType: "application/json;charset=utf-8",
                                        //dataType: "json",
                                        success: function (data) {
                                            //$j('#txtCustomerName').val(customerName);
                                            $j("#woPOID").val(poID);
                                            $j("#hdnGrossWeight").val(data[0].grossWeight);
                                            $j('#lblWorkorderno').text(wono);
                                            //$j('#lblCutWorkorderno').text(wono);
                                            $j('#lblcustomerName').text(data[0].CustomerName);
                                            $j('#lblcustomerName1').text(data[0].CustomerName);
                                            $j('#lblCutcustomerName').text(data[0].CustomerName);
                                            $j('#lblApprovalDate').text(jsondateformatconvert(data[0].ApprovalDate));
                                            $j('#lblCondOfSupply').text(data[0].ConditionOfSupply);
                                            //$j('#lblOpsinvolved').text(data[0].ConditionOfSupply);
                                            $j('#lblHeatTreatment').text(data[0].HeatTreatment);
                                            $j('#lblHardnessMin').text(data[0].HardnessMin);
                                            $j('#lblHardnessMax').text(data[0].HardnessMax);
                                            $j('#lblHardnessUnits').text(data[0].HardnessUnit);


                                            $j('#lblpono').text(data[0].PoNo);
                                            $j('#lblpono1').text(data[0].PoNo);
                                            $j('#lblCutPONo').text(data[0].PoNo);
                                            $j('#txtRMPartName').val(data[0].PartName);
                                            $j('#lblrawMaterial').text(data[0].RawMaterial);
                                            $j('#lblCutRMGrade').text(data[0].RawMaterial);
                                            $j('#txtRMRawMaterial').val(data[0].RawMaterial);
                                            $j('#txtRMSection').val(data[0].Section);
                                            $j('#lblSection').text(data[0].Section);
                                            $j('#lblCutSection').text(data[0].Section);
                                            $j('#hdnSectionId').val(data[0].POSectionId);
                                            $j('#lblCutwt').text(data[0].CutWeight);
                                            $j('#lblCutCTWt').text(data[0].CutWeight);
                                            $j('#lblColorCode').text(data[0].ColorCode);
                                            $j('#lblDieNo').text(data[0].DieNumber);
                                            $j('#lblPartName').text(data[0].PartName);
                                            $j('#lblrawMaterial1').text(data[0].RawMaterial);
                                            $j('#lblSection1').text(data[0].Section);
                                            $j('#lblCutwt1').text(data[0].CutWeight);
                                            $j('#lblColorCode1').text(data[0].ColorCode);
                                            $j('#lblDieNo1').text(data[0].DieNumber);
                                            $j('#lblCutDieNo').text(data[0].DieNumber);
                                            $j('#txtPoQty').text(data[0].QtymentionedinPO);
                                            $j('#lblPOQty').text(data[0].QtymentionedinPO);
                                            $j('#lblCutPOQty').text(data[0].QtymentionedinPO);
                                            var natureOfwork = data[0].NatureOfWork;
                                            if (natureOfwork == '201') {
                                                $j('#lblNatureOfWork').text('Labour job');
                                            }
                                            else if (natureOfwork == '202') {
                                                $j('#lblNatureOfWork').text('With Material');
                                            } else { }
                                            $j("#lblCutLength").text(data[0].CutLength);
                                            $j("#lblCutCutLength").text(data[0].CutLength);
                                            $j("#lblHeatCode").text(data[0].HeatCode);
                                            var hammer = data[0].FeasibilityHammerRequired;
                                            if (hammer == '401') {
                                                $j('#lblCutHammerReq').text('3 Tonne');
                                                $j('#lblHammerReq').text('3 Tonne');

                                            }
                                            else if (hammer == '402') {
                                                $j('#lblCutHammerReq').text('1 .25 Tonne');
                                                $j('#lblHammerReq').text('1 .25 Tonne');
                                            }
                                            else if (hammer == '403') {
                                                $j('#lblCutHammerReq').text('1 Tonne');
                                                $j('#lblHammerReq').text('1 Tonne');
                                            }
                                            else if (hammer == '404') {
                                                $j('#lblCutHammerReq').text('Other');
                                                $j('#lblHammerReq').text('Other');
                                            }
                                            else { }
                                            $j("#txtCustomerName").val(data[0].CustomerName);
                                            var dieNumber = data[0].DieNumber;
                                            getRawMaterialAvailability(data[0].RawMaterial, data[0].Section, data[0].CustomerName, natureOfwork);
                                            getDieAvailability(dieNumber);
                                            getDispatchQty(poID);
                                            getOpsInvolved(poID);
                                            checkpoidstatus(poID);
                                            bindCuttingMachine();
                                            bindForgingMachine();
                                        },
                                        error: function (err) {

                                        }
                                    });
        }
    </script>
    <script>
        $("#btnGenerateReq").click(function(){
            var section =$("#drpSection").val();
            if (section=="Select") {

            }else {
                $("#txtRMSection").val($("#drpSection option:selected").text());
            }
        });

    </script>
    <script>
        function getWOLIst(poID) {
            $.ajax({
                type: "POST",
                url: "../Workorder/getWOListByPOID",
                data: JSON.stringify({ PoID: '' + poID + '' }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    //var append = new Array();

                    for (var i = 0; i < data.length; i++) {
                        //alert(data[i].WorkorderNo);
                        //append.push(data[i].operationinvolvedname);

                        $('#drpWOList').append($("<a class='dropdown-item'>" + data[i].WorkorderNo + "</a>"))
                        //.attr("value", data.WorkorderNo)
                        //.val(data.WorkorderNo));

                        //<a class="dropdown-item" href="#" >
                        //                                                         WO List
                        //                                                      </a>

                    }
                    //append = append.toString();

                    //append = append.replace(/,/g, ", ");
                    //$j("#lblOpsinvolved").text(append);
                }
            });

        }

    </script>

    <script>
        function bindCuttingMachine() {
            var poID = "0";
            $.ajax({

                type: "POST",
                url: "../Workorder/bindForgingMachine",
                data: JSON.stringify({ PoID: '' + poID + '' }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    $("#drpForgingMc").empty();

                    var newOption = $('<option value="Select">Select</option>');
                    $('#drpForgingMc').append(newOption);
                    $.each(data, function (i, data) {
                        $('<option>',
                        {
                            value: data.MachaineID,
                            text: data.MachaineDescription
                        }).html(data.MachaineDescription).appendTo("#drpForgingMc");
                    });
                }
            });
        }
    </script>
    <script>
        function bindForgingMachine() {
            var poID = "0";
            $.ajax({

                type: "POST",
                url: "../Workorder/bindCuttingMachine",
                data: JSON.stringify({ PoID: '' + poID + '' }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    $("#drpCuttingMc").empty();
                    var newOption = $('<option value="Select">Select</option>');
                    $('#drpCuttingMc').append(newOption);
                    $.each(data, function (i, data) {
                        $('<option>',
                        {
                            value: data.MachaineID,
                            text: data.MachaineDescription
                        }).html(data.MachaineDescription).appendTo("#drpCuttingMc");
                    });
                }
            });
        }
    </script>
    <script>

        function getOpsInvolved(poID) {

            $.ajax({

                type: "POST",
                url: "../Workorder/getOpsInvolved",
                data: JSON.stringify({ PoID: '' + poID + '' }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    var append = new Array();
                    for (var i = 0; i < data.length; i++) {

                        append.push(data[i].operationinvolvedname);

                    }
                    append = append.toString();

                    append = append.replace(/,/g, ", ");
                    $j("#lblOpsinvolved").text(append);
                }
            });

        }
    </script>
    <script>
        function getDispatchQty(poID) {
            $("#woPOID").val(poID);
            $.ajax({

                type: "POST",
                url: "../Workorder/getDispatchQty",
                data: JSON.stringify({ PoID: '' + poID + '' }),
                contentType: "application/json;charset=utf-8",
                //dataType: "json",
                success: function (data) {
                    $("#lblTotalDispatchQty").text(data[0]);

                    if ((data[1]) != 0) {
                        $("#lblBalancedQty").text(data[1]);
                    } else {
                        $("#lblBalancedQty").text($("#txtPoQty").text());
                    }
                }
            });

        }
    </script>


    <script>
        function getDieAvailability(dieNumber) {
            $.ajax({
                url: "../Workorder/GetDieAvailability",
                type: "POST",
                dataType: "json",
                data: JSON.stringify({ DieNumber: ' ' + dieNumber + '' }),
                contentType: "application/json;charset=utf-8",
                success: function (data) {
                    if (data != '') {
                        $j('#DieAvailability').text('Yes');
                        $j('#btnGenerateDieReq').hide();
                    }
                    else {
                        $j('#DieAvailability').text('No');
                        $j('#btnGenerateDieReq').show();
                    }
                }
            });

        }


        function getRawMaterialAvailability(RawMaterial, Section, CustomerName, natureOfwork) {
            $j.ajax({
                url: "../Workorder/GetRMAvialbility",
                type: "POST",
                dataType: "json",
                data: JSON.stringify({ RawMaterial: '' + RawMaterial + '', Section: ' ' + Section + '' }),
                contentType: "application/json;charset=utf-8",
                success: function (data) {

                    if (natureOfwork == "202") {
                        if (data == '0') {
                            //$j("#RMAvailability").text('Yes [Available Qty:' + data + ']');
                            $j("#RMAvailability").text('No');
                            $j("#divbtnGenerateReq").show();
                            $j("#btn_Modal").prop('disabled', false);
                            $j("#btnGenerateReq").show();
                        }
                        else {

                            $j("#RMAvailability").text(data);
                            $j("#divbtnGenerateReq").show();
                            $j("#txtCustomerName").val(CustomerName);
                            $j("#iRMAvailabilitysts").css("display", "none");
                            $j("#btnGenerateReq").css("display", "none");
                            $j("#btn_Modal").prop('disabled', false);
                        }

                    }
                        //else if (data != '0' || natureOfwork == "202") {

                        //    $j("#RMAvailability").text(data);
                        //    $j("#divbtnGenerateReq").show();
                        //    $j("#btn_Modal").prop('disabled', true);
                        //}
                    else {

                        $j("#divbtnGenerateReq").hide();
                        $j("#RMAvailability").text('No');
                        $j("#txtCustomerName").val(CustomerName);
                        $j("#btn_Modal").prop('disabled', false);
                        $j("#btnGenerateReq").show();
                    }
                }
            });

        }
    </script>
        <script>
            function jsondateformatconvert(jsondate) {
                var MyDate_String_Value = jsondate;
                var value = new Date
                (
                parseInt(MyDate_String_Value.replace(/(^.*\()|([+-].*$)/g, ''))
                );
                var date = value.getDate();
                if (date < 10) {
                    date = "0" + date;
                } else {
                    date = date;
                }
                var month = value.getMonth() + 1;
                if (month < 10) {
                    month = "0" + month;
                } else {
                    month = month;
                }
                var year = value.getFullYear();
                var hrs = value.getHours();
                var minutes = value.getMinutes();
                var sec = value.getSeconds();
                var day = value.getDay();

                var days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

                var dayName = days[value.getDay()];

                //var d = new Date(dateString);
                //var dayName = d.toString().split(' ')[0];

                var dat = dayName + ", " + date + "-" + month + "-" + year + ", " + hrs + ":" + minutes;
                return dat;
            }
            function jsondateformatconvert1(jsondate) {
                var MyDate_String_Value = jsondate;
                var value = new Date
                (
                parseInt(MyDate_String_Value.replace(/(^.*\()|([+-].*$)/g, ''))
                );
                var date = value.getDate();
                if (date < 10) {
                    date = "0" + date;
                } else {
                    date = date;
                }
                var month = value.getMonth() + 1;
                if (month < 10) {
                    month = "0" + month;
                } else {
                    month = month;
                }
                var year = value.getFullYear();
                var hrs = value.getHours();
                var minutes = value.getMinutes();
                var sec = value.getSeconds();
                var day = value.getDay();

                var days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

                var dayName = days[value.getDay()];

                //var d = new Date(dateString);
                //var dayName = d.toString().split(' ')[0];

                var dat = date + "/" + month + "/" + year;
                return dat;
            }
        </script>
        <script>
            $(document).on("keypress", "input[type=text].Float-Number", function (event) {
                //  $(".Float-Number").keypress(function (event) {
                ///For Positive float
                //if (isNaN(this.value + "" + String.fromCharCode(e.charCode)))
                //    return false;
                $(this).bind("cut copy paste", function (e) {
                    e.preventDefault();
                });
                var value = $("#" + this.id).val();
                //    alert(event.which);
                var iKeyCode = (event.which) ? event.which : event.keyCode
                if (iKeyCode != 46 && iKeyCode != 09 && iKeyCode > 31 && (iKeyCode < 48 || iKeyCode > 57)) {
                    //  alert("Enter Numbers Only");
                    event.preventDefault();
                    return false;
                }
                if (event.which < 45 || event.which > 58 || event.which == 47) {
                    if (event.which != 8) {
                        return false;
                        event.preventDefault();
                    }
                } // prevent if not number/dot

                if (event.which == 46 && value.indexOf('.') != -1) {
                    return false;
                    event.preventDefault();
                } // prevent if already dot

                if (event.which == 45 && value.indexOf('-') != -1) {
                    return false;
                    event.preventDefault();
                } // prevent if already dot

                if (event.which == 45 && value.length > 0) {
                    event.preventDefault();
                } // prevent if already -

                return true;


            });
            function search() {
                $("#txt_search").show();
                var search = $("#txt_search").val();
                if (search != "") {
                    searchbyall(search);
                }

            }
            function searchbyall(search) {
                $.ajax({
                    type: "POST",
                    url: "../Workorder/searchbyall",
                    // data: params,
                    data: JSON.stringify({ search: ' ' + search + '' }),
                    contentType: "application/json;charset=utf-8",
                    // dataType: "json",
                    success: function (data) {
                        $('#ullslistbind').empty();
                        var items = [];
                        for (var i = 0; i < data.length; i++) {
                            var appdt = jsondateformatconvert('' + data[i].ApprovalDate + '');

                            items.push('<li style="display:none" class="WoNo"><input type="hidden" value= ""  id="hdnwono1" /></li> <li class="media p-3 b-b has-hover liPOS" onclick="fetchPO(' + data[i].po_id + ')"><input type="hidden" value=' + data[i].po_id + ' class="pono" /> <input type="hidden" value=' + data[i].CustomerPONo + '  class="pono" /><div type="hidden" value=' + data[i].po_id + ' class="poID" /><div><div class="avatar avatar-md mr-3 mt-1 float-left"><span class="avatar-letter avatar-letter-' + data[i].customerName.charAt(0).toLowerCase() + ' avatar-md circle"></span></div><div class="media-body text-truncate"><small class="float-right"><span title="PO Approval Date"> ' + appdt + '</span><a class="" href="#" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a></small><h6 class="mt-0 mb-1 font-weight-normal">' + data[i].CustomerPONo + '</h6> <h6 class="font-weight-normal" sty>' + data[i].customerName + '</h6><small title="Die No">Die # ' + data[i].DieNumber + '&nbsp;</small><small title="Quotation No"> | &nbsp; Quotation # ' + data[i].QtymentionedinPO + '</small></div></div></li>');

                        }
                        $('#ullslistbind').append(items.join(''));
                    },
                    error: function (err) {
                        alert('Error occured');

                    }
                });
            }
            function jsondateformatconvert(jsondate) {

                var MyDate_String_Value = jsondate;
                var value = new Date
                (
                parseInt(MyDate_String_Value.replace(/(^.*\()|([+-].*$)/g, ''))
                );
                var date = value.getDate();
                if (date < 10) {
                    date = "0" + date;
                } else {
                    date = date;
                }
                var month = value.getMonth() + 1;
                if (month < 10) {
                    month = "0" + month;
                } else {
                    month = month;
                }
                var year = value.getFullYear();
                var hrs = value.getHours();
                var minutes = value.getMinutes();
                var sec = value.getSeconds();
                var day = value.getDay();

                var days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];

                var dayName = days[value.getDay()];
                var monthlist = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUNE', 'JULY', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
                var monthname = monthlist[value.getMonth()];
                //var d = new Date(dateString);
                //var dayName = d.toString().split(' ')[0];
                var result = "";
                var dat = date + "-" + monthname;

                return dat;
            }
        </script>
}